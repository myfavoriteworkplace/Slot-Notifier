/opt/render/project/src/dist/index.cjs:76
		`;await r.execute(v`CREATE SCHEMA IF NOT EXISTS ${v.identifier(a)}`),await r.execute(s);let u=(await r.all(v`select id, hash, created_at from ${v.identifier(a)}.${v.identifier(n)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(v.raw(p));await c.execute(v`insert into ${v.identifier(a)}.${v.identifier(n)} ("hash", "created_at") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[v`with `];for(let[i,n]of e.entries())r.push(v`${v.identifier(n._.alias)} as (${n._.sql})`),i<e.length-1&&r.push(v`, `);return r.push(v` `),v.join(r)}buildDeleteQuery({table:e,where:r,returning:i,withList:n}){let a=this.buildWithCTE(n),s=i?v` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,o=r?v` where ${r}`:void 0;return v`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let i=e[C.Symbol.Columns],n=Object.keys(i).filter(s=>r[s]!==void 0||i[s]?.onUpdateFn!==void 0),a=n.length;return v.join(n.flatMap((s,o)=>{let u=i[s],c=r[s]??v.param(u.onUpdateFn(),u),l=v`${v.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,v.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:r,where:i,returning:n,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Le.Symbol.Name],l=e[Le.Symbol.Schema],p=e[Le.Symbol.OriginalName],d=c===p?void 0:c,f=v`${l?v`${v.identifier(l)}.`:void 0}${v.identifier(p)}${d&&v` ${v.identifier(d)}`}`,y=this.buildUpdateSet(e,r),g=s&&v.join([v.raw(" from "),this.buildFromTable(s)]),x=this.buildJoins(o),w=n?v` returning ${this.buildSelection(n,{isSingleTable:!s})}`:void 0,E=i?v` where ${i}`:void 0;return v`${u}update ${f} set ${y}${g}${x}${E}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let i=e.length,n=e.flatMap(({field:a},s)=>{let o=[];if(b(a,A.Aliased)&&a.isSelectionField)o.push(v.identifier(a.fieldAlias));else if(b(a,A.Aliased)||b(a,A)){let u=b(a,A.Aliased)?a.sql:a;r?o.push(new A(u.queryChunks.map(c=>b(c,k)?v.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,A.Aliased)&&o.push(v` as ${v.identifier(a.fieldAlias)}`)}else b(a,ee)&&(r?o.push(v.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<i-1&&o.push(v`, `),o});return v.join(n)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[i,n]of e.entries()){i===0&&r.push(v` `);let a=n.table,s=n.lateral?v` lateral`:void 0;if(b(a,Le)){let o=a[Le.Symbol.Name],u=a[Le.Symbol.Schema],c=a[Le.Symbol.OriginalName],l=o===c?void 0:n.alias;r.push(v`${v.raw(n.joinType)} join${s} ${u?v`${v.identifier(u)}.`:void 0}${v.identifier(c)}${l&&v` ${v.identifier(l)}`} on ${n.on}`)}else if(b(a,Ye)){let o=a[le].name,u=a[le].schema,c=a[le].originalName,l=o===c?void 0:n.alias;r.push(v`${v.raw(n.joinType)} join${s} ${u?v`${v.identifier(u)}.`:void 0}${v.identifier(c)}${l&&v` ${v.identifier(l)}`} on ${n.on}`)}else r.push(v`${v.raw(n.joinType)} join${s} ${a} on ${n.on}`);i<e.length-1&&r.push(v` `)}return v.join(r)}buildFromTable(e){if(b(e,C)&&e[C.Symbol.OriginalName]!==e[C.Symbol.Name]){let r=v`${v.identifier(e[C.Symbol.OriginalName])}`;return e[C.Symbol.Schema]&&(r=v`${v.identifier(e[C.Symbol.Schema])}.${r}`),v`${r} ${v.identifier(e[C.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:i,where:n,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let g=i??Ct(r);for(let fe of g)if(b(fe.field,ee)&&lt(fe.field.table)!==(b(s,Pe)?s._.alias:b(s,sn)?s[le].name:b(s,A)?void 0:lt(s))&&!(_e=>o?.some(({alias:vt})=>vt===(_e[C.Symbol.IsAlias]?lt(_e):_e[C.Symbol.BaseName])))(fe.field.table)){let _e=lt(fe.field.table);throw new Error(`Your "${fe.path.join("->")}" field references a column "${_e}"."${fe.field.name}", but the table "${_e}" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),E;f&&(E=f===!0?v` distinct`:v` distinct on (${v.join(f.on,v`, `)})`);let S=this.buildSelection(g,{isSingleTable:x}),I=this.buildFromTable(s),$=this.buildJoins(o),R=n?v` where ${n}`:void 0,N=a?v` having ${a}`:void 0,D;u&&u.length>0&&(D=v` order by ${v.join(u,v`, `)}`);let X;c&&c.length>0&&(X=v` group by ${v.join(c,v`, `)}`);let je=typeof l=="object"||typeof l=="number"&&l>=0?v` limit ${l}`:void 0,at=p?v` offset ${p}`:void 0,$e=v.empty();if(d){let fe=v` for ${v.raw(d.strength)}`;d.config.of&&fe.append(v` of ${v.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],v`, `)}`),d.config.noWait?fe.append(v` no wait`):d.config.skipLocked&&fe.append(v` skip locked`),$e.append(fe)}let Se=v`${w}select${E} ${S} from ${I}${$}${R}${X}${N}${D}${je}${at}${$e}`;return y.length>0?this.buildSetOperations(Se,y):Se}buildSetOperations(e,r){let[i,...n]=r;if(!i)throw new Error("Cannot pass undefined values to any set operator");return n.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:i}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:i}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:i,rightSelect:n,limit:a,orderBy:s,offset:o}}){let u=v`(${e.getSQL()}) `,c=v`(${n.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let g of s)if(b(g,k))y.push(v.identifier(g.name));else if(b(g,A)){for(let x=0;x<g.queryChunks.length;x++){let w=g.queryChunks[x];b(w,k)&&(g.queryChunks[x]=v.identifier(w.name))}y.push(v`${g}`)}else y.push(v`${g}`);l=v` order by ${v.join(y,v`, `)} `}let p=typeof a=="object"||typeof a=="number"&&a>=0?v` limit ${a}`:void 0,d=v.raw(`${r} ${i?"all ":""}`),f=o?v` offset ${o}`:void 0;return v`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:i,returning:n,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[C.Symbol.Columns],l=Object.entries(c).filter(([w,E])=>!E.shouldDisableInsert()),p=l.map(([,w])=>v.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,A)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(v.raw("values "));for(let[E,S]of w.entries()){let I=[];for(let[$,R]of l){let N=S[$];if(N===void 0||b(N,pt)&&N.value===void 0)if(R.defaultFn!==void 0){let D=R.defaultFn(),X=b(D,A)?D:v.param(D,R);I.push(X)}else if(!R.default&&R.onUpdateFn!==void 0){let D=R.onUpdateFn(),X=b(D,A)?D:v.param(D,R);I.push(X)}else I.push(v`default`);else I.push(N)}u.push(I),E<w.length-1&&u.push(v`, `)}}let d=this.buildWithCTE(a),f=v.join(u),y=n?v` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,g=i?v` on conflict ${i}`:void 0,x=o===!0?v`overriding system value `:void 0;return v`${d}insert into ${e} ${p} ${x}${f}${g}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:i}){let n=r?v` concurrently`:void 0,a=i?v` with no data`:void 0;return v`refresh materialized view${n} ${e}${a}`}prepareTyping(e){return b(e,La)||b(e,Ma)?"json":b(e,Fa)?"decimal":b(e,za)?"time":b(e,$a)||b(e,Ua)?"timestamp":b(e,Da)||b(e,Ra)?"date":b(e,Qa)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:i,table:n,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,g=[];if(s===!0)l=Object.entries(a.columns).map(([E,S])=>({dbKey:S.name,tsKey:E,field:Gt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([N,D])=>[N,Gt(D,o)]));if(s.where){let N=typeof s.where=="function"?s.where(w,Vw()):s.where;y=N&&ja(N,o)}let E=[],S=[];if(s.columns){let N=!1;for(let[D,X]of Object.entries(s.columns))X!==void 0&&D in a.columns&&(!N&&X===!0&&(N=!0),S.push(D));S.length>0&&(S=N?S.filter(D=>s.columns?.[D]===!0):Object.keys(a.columns).filter(D=>!S.includes(D)))}else S=Object.keys(a.columns);for(let N of S){let D=a.columns[N];E.push({tsKey:N,value:D})}let I=[];s.with&&(I=Object.entries(s.with).filter(N=>!!N[1]).map(([N,D])=>({tsKey:N,queryConfig:D,relation:a.relations[N]})));let $;if(s.extras){$=typeof s.extras=="function"?s.extras(w,{sql:v}):s.extras;for(let[N,D]of Object.entries($))E.push({tsKey:N,value:up(D,o)})}for(let{tsKey:N,value:D}of E)l.push({dbKey:b(D,A.Aliased)?D.fieldAlias:a.columns[N].name,tsKey:N,field:b(D,ee)?Gt(D,o):D,relationTableTsKey:void 0,isJson:!1,selection:[]});let R=typeof s.orderBy=="function"?s.orderBy(w,Gw()):s.orderBy??[];Array.isArray(R)||(R=[R]),f=R.map(N=>b(N,ee)?Gt(N,o):ja(N,o)),p=s.limit,d=s.offset;for(let{tsKey:N,queryConfig:D,relation:X}of I){let je=Ww(r,i,X),at=Gr(X.referencedTable),$e=i[at],Se=`${o}_${N}`,fe=Wt(...je.fields.map((Ir,Dn)=>Z(Gt(je.references[Dn],Se),Gt(Ir,o)))),_e=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:i,table:e[$e],tableConfig:r[$e],queryConfig:b(X,br)?D===!0?{limit:1}:{...D,limit:1}:D,tableAlias:Se,joinOn:fe,nestedQueryRelation:X}),vt=v`${v.identifier(Se)}.${v.identifier("data")}`.as(N);g.push({on:v`true`,table:new Pe(_e.sql,{},Se),alias:Se,joinType:"left",lateral:!0}),l.push({dbKey:N,tsKey:N,field:vt,relationTableTsKey:$e,isJson:!0,selection:_e.selection})}}if(l.length===0)throw new Va({message:`No fields selected for table "${a.tsName}" ("${o}")`});let x;if(y=Wt(c,y),u){let w=v`json_build_array(${v.join(l.map(({field:I,tsKey:$,isJson:R})=>R?v`${v.identifier(`${o}_${$}`)}.${v.identifier("data")}`:b(I,A.Aliased)?I.sql:I),v`, `)})`;b(u,Ga)&&(w=v`coalesce(json_agg(${w}${f.length>0?v` order by ${v.join(f,v`, `)}`:void 0}), '[]'::json)`);let E=[{dbKey:"data",tsKey:"data",field:w.as("data"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:Oa(n,o),fields:{},fieldsFlat:[{path:[],field:v.raw("*")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=Oa(n,o),x=this.buildSelectQuery({table:b(x,Le)?x:new Pe(x,{},o),fields:{},fieldsFlat:E.map(({field:I})=>({path:[],field:b(I,ee)?Gt(I,o):I})),joins:g,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:Oa(n,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,ee)?Gt(w,o):w})),joins:g,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var Go=class{static[m]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var He=class{static[m]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,i=e,n;return this.fields?n=this.fields:b(i,Pe)?n=Object.fromEntries(Object.keys(i._.selectedFields).map(a=>[a,i[a]])):b(i,sn)?n=i[le].selectedFields:b(i,A)?n={}:n=Bo(i),new Ko({table:i,fields:n,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},Ad=class extends Go{static[m]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:i,session:n,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=i,this.session=n,this.dialect=a,this._={selectedFields:r},this.tableName=tr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,i)=>{let n=this.tableName,a=tr(r);if(typeof a=="string"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof n=="string"&&(this.config.fields={[n]:this.config.fields}),typeof a=="string"&&!b(r,A))){let s=b(r,Pe)?r._.selectedFields:b(r,Ye)?r[le].selectedFields:r[C.Symbol.Columns];this.config.fields[a]=s}if(typeof i=="function"&&(i=i(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:i,table:r,joinType:e,alias:a}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return i=>{let n=typeof i=="function"?i(A3()):i;if(!qa(this.getSelectedFields(),n.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),i=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=i:this.config.orderBy=i}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new Pe(this.getSQL(),this.config.fields,e),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new Te({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},Ko=class extends Ad{static[m]="PgSelect";_prepare(e){let{session:r,config:i,dialect:n,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ue.startActiveSpan("drizzle.prepareQuery",()=>{let o=Ct(i.fields),u=r.prepareQuery(n.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};J0(Ko,[Qe]);function on(t,e){return(r,i,...n)=>{let a=[i,...n].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!qa(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(a)}}var A3=()=>({union:P3,unionAll:I3,intersect:N3,intersectAll:O3,except:j3,exceptAll:q3}),P3=on("union",!1),I3=on("union",!0),N3=on("intersect",!1),O3=on("intersect",!0),j3=on("except",!1),q3=on("except",!0);var cn=class{static[m]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=b(e,wr)?e:void 0,this.dialectConfig=b(e,wr)?void 0:e}$with=(e,r)=>{let i=this;return{as:a=>(typeof a=="function"&&(a=a(i)),new Proxy(new Yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let r=this;function i(s){return new He({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function n(s){return new He({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new He({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:i,selectDistinct:n,selectDistinctOn:a}}select(e){return new He({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new He({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new He({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new wr(this.dialectConfig)),this.dialect}};var Ka=class{constructor(e,r,i,n,a){this.table=e,this.session=r,this.dialect=i,this.withList=n,this.overridingSystemValue_=a}static[m]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let r=e.map(i=>{let n={},a=this.table[C.Symbol.Columns];for(let s of Object.keys(i)){let o=i[s];n[s]=b(o,A)?o:new pt(o,a[s])}return n});return new Wo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e=="function"?e(new cn):e;if(!b(r,A)&&!qa(this.table[Do],r._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new Wo(this.table,r,this.session,this.dialect,this.withList,!0)}},Wo=class extends Qe{constructor(e,r,i,n,a,s,o){super(),this.session=i,this.dialect=n,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[m]="PgInsert";config;returning(e=this.config.table[C.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Ct(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=v`do nothing`;else{let r="";r=Array.isArray(e.target)?e.target.map(n=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(n))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let i=e.where?v` where ${e.where}`:void 0;this.config.onConflict=v`(${v.raw(r)})${i} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let r=e.where?v` where ${e.where}`:void 0,i=e.targetWhere?v` where ${e.targetWhere}`:void 0,n=e.setWhere?v` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,Ro(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=v`(${v.raw(s)})${i} do update set ${a}${r}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Te({alias:lt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Zo=class extends Qe{constructor(e,r,i){super(),this.session=r,this.dialect=i,this.config={view:e}}static[m]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Wa=class{constructor(e,r,i,n){this.table=e,this.session=r,this.dialect=i,this.withList=n}static[m]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Pd(this.table,Ro(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Pd=class extends Qe{constructor(e,r,i,n,a){super(),this.session=i,this.dialect=n,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=tr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[m]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let r=e,i=tr(r);return typeof i=="string"&&(this.joinsNotNullableMap[i]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Le)?e[C.Symbol.Columns]:b(e,Pe)?e._.selectedFields:e[le].selectedFields}createJoin(e){return(r,i)=>{let n=tr(r);if(typeof n=="string"&&this.config.joins.some(a=>a.alias===n))throw new Error(`Alias "${n}" is already used in this query`);if(typeof i=="function"){let a=this.config.from&&!b(this.config.from,A)?this.getTableLikeFields(this.config.from):void 0;i=i(new Proxy(this.config.table[C.Symbol.Columns],new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:i,table:r,joinType:e,alias:n}),typeof n=="string")switch(e){case"left":{this.joinsNotNullableMap[n]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[n]=!0;break}case"inner":{this.joinsNotNullableMap[n]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[n]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[C.Symbol.Columns]),this.config.from)){let r=tr(this.config.from);if(typeof r=="string"&&this.config.from&&!b(this.config.from,A)){let i=this.getTableLikeFields(this.config.from);e[r]=i}for(let i of this.config.joins){let n=tr(i.table);if(typeof n=="string"&&!b(i.table,A)){let a=this.getTableLikeFields(i.table);e[n]=a}}}return this.config.returningFields=e,this.config.returning=Ct(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Te({alias:lt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Jo=class t extends A{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[m]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,r){return v`(select count(*) from ${e}${v.raw(" where ").if(r)}${r})`}static buildCount(e,r){return v`select count(*) as count from ${e}${v.raw(" where ").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Xo=class{constructor(e,r,i,n,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=i,this.table=n,this.tableConfig=a,this.dialect=s,this.session=o}static[m]="PgRelationalQueryBuilder";findMany(e){return new Yo(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Yo(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},Yo=class extends Qe{constructor(e,r,i,n,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=i,this.table=n,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[m]="PgRelationalQuery";_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>{let{query:r,builtQuery:i}=this._toSQL();return this.session.prepareQuery(i,void 0,e,!0,(n,a)=>{let s=n.map(o=>Ho(this.schema,this.tableConfig,o,r.selection,a));return this.mode==="first"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var ec=class extends Qe{constructor(e,r,i,n){super(),this.execute=e,this.sql=r,this.query=i,this.mapBatchResult=n}static[m]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var un=class{constructor(e,r,i){if(this.dialect=e,this.session=r,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[n,a]of Object.entries(this._.schema))this.query[n]=new Xo(i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[n],a,e,r)}static[m]="PgDatabase";query;$with=(e,r)=>{let i=this;return{as:a=>(typeof a=="function"&&(a=a(new cn(i.dialect))),new Proxy(new Yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,r){return new Jo({source:e,filters:r,session:this.session})}with(...e){let r=this;function i(c){return new He({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function n(c){return new He({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new He({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Wa(c,r.session,r.dialect,e)}function o(c){return new Ka(c,r.session,r.dialect,e)}function u(c){return new Ha(c,r.session,r.dialect,e)}return{select:i,selectDistinct:n,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new He({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new He({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new He({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Wa(e,this.session,this.dialect)}insert(e){return new Ka(e,this.session,this.dialect)}delete(e){return new Ha(e,this.session,this.dialect)}refreshMaterializedView(e){return new Zo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e=="string"?v.raw(e):e.getSQL(),i=this.dialect.sqlToQuery(r),n=this.session.prepareQuery(i,void 0,void 0,!1);return new ec(()=>n.execute(void 0,this.authToken),r,i,a=>n.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var Id=class{constructor(e,r){this.unique=e,this.name=r}static[m]="PgIndexBuilderOn";on(...e){return new Za(e.map(r=>{if(b(r,A))return r;r=r;let i=new Xi(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),i}),this.unique,!1,this.name)}onOnly(...e){return new Za(e.map(r=>{if(b(r,A))return r;r=r;let i=new Xi(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,i}),this.unique,!0,this.name)}using(e,...r){return new Za(r.map(i=>{if(b(i,A))return i;i=i;let n=new Xi(i.name,!!i.keyAsName,i.columnType,i.indexConfig);return i.indexConfig=JSON.parse(JSON.stringify(i.defaultConfig)),n}),this.unique,!0,this.name,e)}},Za=class{static[m]="PgIndexBuilder";config;constructor(e,r,i,n,a="btree"){this.config={name:n,columns:e,unique:r,only:i,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new Nd(this.config,e)}},Nd=class{static[m]="PgIndex";config;constructor(e,r){this.config={...e,table:r}}};function Xw(t){return new Id(!1,t)}var tc=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[m]="PgPreparedQuery";joinsNotNullableMap},rc=class{constructor(e){this.dialect=e}static[m]="PgSession";execute(e,r){return ue.startActiveSpan("drizzle.operation",()=>ue.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let i=await this.execute(e,r);return Number(i[0].count)}},ic=class extends un{constructor(e,r,i,n=0){super(e,r,i),this.schema=i,this.nestedIndex=n}static[m]="PgTransaction";rollback(){throw new Fo}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable=="boolean"&&r.push(e.deferrable?"deferrable":"not deferrable"),v.raw(r.join(" "))}setTransaction(e){return this.session.execute(v`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Od=class{static[m]="ConsoleLogWriter";write(e){console.log(e)}},nc=class{static[m]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new Od}logQuery(e,r){let i=r.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),n=i.length?` -- params: [${i.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},ac=class{static[m]="NoopLogger";logQuery(){}};var J;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function r(n){throw new Error}t.assertNever=r,t.arrayToEnum=n=>{let a={};for(let s of n)a[s]=s;return a},t.getValidEnumValues=n=>{let a=t.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),s={};for(let o of a)s[o]=n[o];return t.objectValues(s)},t.objectValues=n=>t.objectKeys(n).map(function(a){return n[a]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let a=[];for(let s in n)Object.prototype.hasOwnProperty.call(n,s)&&a.push(s);return a},t.find=(n,a)=>{for(let s of n)if(a(s))return s},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function i(n,a=" | "){return n.map(s=>typeof s=="string"?`'${s}'`:s).join(a)}t.joinValues=i,t.jsonStringifyReplacer=(n,a)=>typeof a=="bigint"?a.toString():a})(J||(J={}));var qd;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(qd||(qd={}));var P=J.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),nr=t=>{switch(typeof t){case"undefined":return P.undefined;case"string":return P.string;case"number":return isNaN(t)?P.nan:P.number;case"boolean":return P.boolean;case"function":return P.function;case"bigint":return P.bigint;case"symbol":return P.symbol;case"object":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?P.promise:typeof Map<"u"&&t instanceof Map?P.map:typeof Set<"u"&&t instanceof Set?P.set:typeof Date<"u"&&t instanceof Date?P.date:P.object;default:return P.unknown}},_=J.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),D3=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),xt=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(a){return a.message},i={_errors:[]},n=a=>{for(let s of a.issues)if(s.code==="invalid_union")s.unionErrors.map(n);else if(s.code==="invalid_return_type")n(s.returnTypeError);else if(s.code==="invalid_arguments")n(s.argumentsError);else if(s.path.length===0)i._errors.push(r(s));else{let o=i,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return n(this),i}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,J.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},i=[];for(let n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):i.push(e(n));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}};xt.create=t=>new xt(t);var dn=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,J.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${J.joinValues(t.keys,", ")}`;break;case _.invalid_union:r="Invalid input";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${J.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${J.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r="Invalid function arguments";break;case _.invalid_return_type:r="Invalid function return type";break;case _.invalid_date:r="Invalid date";break;case _.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:J.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case _.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case _.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case _.custom:r="Invalid input";break;case _.invalid_intersection_types:r="Intersection results could not be merged";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r="Number must be finite";break;default:r=e.defaultError,J.assertNever(t)}return{message:r}},r1=dn;function R3(t){r1=t}function sc(){return r1}var oc=t=>{let{data:e,path:r,errorMaps:i,issueData:n}=t,a=[...r,...n.path||[]],s={...n,path:a};if(n.message!==void 0)return{...n,path:a,message:n.message};let o="",u=i.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...n,path:a,message:o}},B3=[];function T(t,e){let r=sc(),i=oc({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===dn?void 0:dn].filter(n=>!!n)});t.common.issues.push(i)}var Ve=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let i=[];for(let n of r){if(n.status==="aborted")return M;n.status==="dirty"&&e.dirty(),i.push(n.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,r){let i=[];for(let n of r){let a=await n.key,s=await n.value;i.push({key:a,value:s})}return t.mergeObjectSync(e,i)}static mergeObjectSync(e,r){let i={};for(let n of r){let{key:a,value:s}=n;if(a.status==="aborted"||s.status==="aborted")return M;a.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof s.value<"u"||n.alwaysSet)&&(i[a.value]=s.value)}return{status:e.value,value:i}}},M=Object.freeze({status:"aborted"}),pn=t=>({status:"dirty",value:t}),et=t=>({status:"valid",value:t}),Dd=t=>t.status==="aborted",Rd=t=>t.status==="dirty",Zr=t=>t.status==="valid",Ya=t=>typeof Promise<"u"&&t instanceof Promise;function cc(t,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)}function i1(t,e,r,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}var q;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(q||(q={}));var Ja,Xa,Pt=class{constructor(e,r,i,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=i,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Yw=(t,e)=>{if(Zr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new xt(t.common.issues);return this._error=r,this._error}}};function Q(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:i,description:n}=t;if(e&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(s,o)=>{var u,c;let{message:l}=t;return s.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:(u=l??i)!==null&&u!==void 0?u:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=l??r)!==null&&c!==void 0?c:o.defaultError}},description:n}}var H=class{get description(){return this._def.description}_getType(e){return nr(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ve,ctx:{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Ya(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let i=this.safeParse(e,r);if(i.success)return i.data;throw i.error}safeParse(e,r){var i;let n={common:{issues:[],async:(i=r?.async)!==null&&i!==void 0?i:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},a=this._parseSync({data:e,path:n.path,parent:n});return Yw(n,a)}"~validate"(e){var r,i;let n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)};if(!this["~standard"].async)try{let a=this._parseSync({data:e,path:[],parent:n});return Zr(a)?{value:a.value}:{issues:n.common.issues}}catch(a){!((i=(r=a?.message)===null||r===void 0?void 0:r.toLowerCase())===null||i===void 0)&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(a=>Zr(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(e,r){let i=await this.safeParseAsync(e,r);if(i.success)return i.data;throw i.error}async safeParseAsync(e,r){let i={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},n=this._parse({data:e,path:i.path,parent:i}),a=await(Ya(n)?n:Promise.resolve(n));return Yw(i,a)}refine(e,r){let i=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,a)=>{let s=e(n),o=()=>a.addIssue({code:_.custom,...i(n)});return typeof Promise<"u"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((i,n)=>e(i)?!0:(n.addIssue(typeof r=="function"?r(i,n):r),!1))}_refinement(e){return new bt({schema:this,typeName:B.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return At.create(this,this._def)}nullable(){return Jt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return sr.create(this)}promise(){return kr.create(this,this._def)}or(e){return ii.create([this,e],this._def)}and(e){return ni.create(this,e,this._def)}transform(e){return new bt({...Q(this._def),schema:this,typeName:B.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new ui({...Q(this._def),innerType:this,defaultValue:r,typeName:B.ZodDefault})}brand(){return new es({typeName:B.ZodBranded,type:this,...Q(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new li({...Q(this._def),innerType:this,catchValue:r,typeName:B.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return ts.create(this,e)}readonly(){return pi.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M3=/^c[^\s-]{8,}$/i,L3=/^[0-9a-z]+$/,F3=/^[0-9A-HJKMNP-TV-Z]{26}$/i,z3=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$3=/^[a-z0-9_-]{21}$/i,U3=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Q3=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,H3=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,V3="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",jd,G3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,K3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,W3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,J3=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,X3=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,n1="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Y3=new RegExp(`^${n1}$`);function a1(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function eI(t){return new RegExp(`^${a1(t)}$`)}function s1(t){let e=`${n1}T${a1(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function tI(t,e){return!!((e==="v4"||!e)&&G3.test(t)||(e==="v6"||!e)&&W3.test(t))}function rI(t,e){if(!U3.test(t))return!1;try{let[r]=t.split("."),i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function iI(t,e){return!!((e==="v4"||!e)&&K3.test(t)||(e==="v6"||!e)&&Z3.test(t))}var Sr=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),M}let i=new Ve,n;for(let a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="max")e.data.length>a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="length"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(n=this._getOrReturnCtx(e,n),s?T(n,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&T(n,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),i.dirty())}else if(a.kind==="email")H3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"email",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="emoji")jd||(jd=new RegExp(V3,"u")),jd.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"emoji",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="uuid")z3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"uuid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="nanoid")$3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"nanoid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid")M3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cuid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid2")L3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cuid2",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="ulid")F3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"ulid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),T(n,{validation:"url",code:_.invalid_string,message:a.message}),i.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"regex",code:_.invalid_string,message:a.message}),i.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),i.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),i.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),i.dirty()):a.kind==="datetime"?s1(a).test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"datetime",message:a.message}),i.dirty()):a.kind==="date"?Y3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"date",message:a.message}),i.dirty()):a.kind==="time"?eI(a).test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"time",message:a.message}),i.dirty()):a.kind==="duration"?Q3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"duration",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="ip"?tI(e.data,a.version)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"ip",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="jwt"?rI(e.data,a.alg)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"jwt",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="cidr"?iI(e.data,a.version)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cidr",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="base64"?J3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"base64",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="base64url"?X3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"base64url",code:_.invalid_string,message:a.message}),i.dirty()):J.assertNever(a);return{status:i.value,value:e.data}}_regex(e,r,i){return this.refinement(n=>e.test(n),{validation:r,code:_.invalid_string,...q.errToObj(i)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...q.errToObj(e)})}url(e){return this._addCheck({kind:"url",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...q.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...q.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...q.errToObj(e)})}datetime(e){var r,i;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(i=e?.local)!==null&&i!==void 0?i:!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Sr.create=t=>{var e;return new Sr({checks:[],typeName:B.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};function nI(t,e){let r=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,n=r>i?r:i,a=parseInt(t.toFixed(n).replace(".","")),s=parseInt(e.toFixed(n).replace(".",""));return a%s/Math.pow(10,n)}var Jr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),M}let i,n=new Ve;for(let a of this._def.checks)a.kind==="int"?J.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:_.invalid_type,expected:"integer",received:"float",message:a.message}),n.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="multipleOf"?nI(e.data,a.value)!==0&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_finite,message:a.message}),n.dirty()):J.assertNever(a);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:q.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:q.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:q.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&J.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Jr.create=t=>new Jr({checks:[],typeName:B.ZodNumber,coerce:t?.coerce||!1,...Q(t)});var Xr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==P.bigint)return this._getInvalidInput(e);let i,n=new Ve;for(let a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):J.assertNever(a);return{status:n.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return T(r,{code:_.invalid_type,expected:P.bigint,received:r.parsedType}),M}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:q.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Xr.create=t=>{var e;return new Xr({checks:[],typeName:B.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};var Yr=class extends H{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==P.boolean){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.boolean,received:i.parsedType}),M}return et(e.data)}};Yr.create=t=>new Yr({typeName:B.ZodBoolean,coerce:t?.coerce||!1,...Q(t)});var ei=class t extends H{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==P.date){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.date,received:a.parsedType}),M}if(isNaN(e.data.getTime())){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_date}),M}let i=new Ve,n;for(let a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),i.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),i.dirty()):J.assertNever(a);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:q.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:q.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};ei.create=t=>new ei({checks:[],coerce:t?.coerce||!1,typeName:B.ZodDate,...Q(t)});var fn=class extends H{_parse(e){if(this._getType(e)!==P.symbol){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.symbol,received:i.parsedType}),M}return et(e.data)}};fn.create=t=>new fn({typeName:B.ZodSymbol,...Q(t)});var ti=class extends H{_parse(e){if(this._getType(e)!==P.undefined){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.undefined,received:i.parsedType}),M}return et(e.data)}};ti.create=t=>new ti({typeName:B.ZodUndefined,...Q(t)});var ri=class extends H{_parse(e){if(this._getType(e)!==P.null){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,
==> Exited with status 1
==> Common ways to troubleshoot your deploy: https://render.com/docs/troubleshooting-deploys
==> Running 'npm run start'
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/opt/render/project/src/dist/index.cjs:76
		`;await r.execute(v`CREATE SCHEMA IF NOT EXISTS ${v.identifier(a)}`),await r.execute(s);let u=(await r.all(v`select id, hash, created_at from ${v.identifier(a)}.${v.identifier(n)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(v.raw(p));await c.execute(v`insert into ${v.identifier(a)}.${v.identifier(n)} ("hash", "created_at") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[v`with `];for(let[i,n]of e.entries())r.push(v`${v.identifier(n._.alias)} as (${n._.sql})`),i<e.length-1&&r.push(v`, `);return r.push(v` `),v.join(r)}buildDeleteQuery({table:e,where:r,returning:i,withList:n}){let a=this.buildWithCTE(n),s=i?v` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,o=r?v` where ${r}`:void 0;return v`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let i=e[C.Symbol.Columns],n=Object.keys(i).filter(s=>r[s]!==void 0||i[s]?.onUpdateFn!==void 0),a=n.length;return v.join(n.flatMap((s,o)=>{let u=i[s],c=r[s]??v.param(u.onUpdateFn(),u),l=v`${v.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,v.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:r,where:i,returning:n,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Le.Symbol.Name],l=e[Le.Symbol.Schema],p=e[Le.Symbol.OriginalName],d=c===p?void 0:c,f=v`${l?v`${v.identifier(l)}.`:void 0}${v.identifier(p)}${d&&v` ${v.identifier(d)}`}`,y=this.buildUpdateSet(e,r),g=s&&v.join([v.raw(" from "),this.buildFromTable(s)]),x=this.buildJoins(o),w=n?v` returning ${this.buildSelection(n,{isSingleTable:!s})}`:void 0,E=i?v` where ${i}`:void 0;return v`${u}update ${f} set ${y}${g}${x}${E}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let i=e.length,n=e.flatMap(({field:a},s)=>{let o=[];if(b(a,A.Aliased)&&a.isSelectionField)o.push(v.identifier(a.fieldAlias));else if(b(a,A.Aliased)||b(a,A)){let u=b(a,A.Aliased)?a.sql:a;r?o.push(new A(u.queryChunks.map(c=>b(c,k)?v.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,A.Aliased)&&o.push(v` as ${v.identifier(a.fieldAlias)}`)}else b(a,ee)&&(r?o.push(v.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<i-1&&o.push(v`, `),o});return v.join(n)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[i,n]of e.entries()){i===0&&r.push(v` `);let a=n.table,s=n.lateral?v` lateral`:void 0;if(b(a,Le)){let o=a[Le.Symbol.Name],u=a[Le.Symbol.Schema],c=a[Le.Symbol.OriginalName],l=o===c?void 0:n.alias;r.push(v`${v.raw(n.joinType)} join${s} ${u?v`${v.identifier(u)}.`:void 0}${v.identifier(c)}${l&&v` ${v.identifier(l)}`} on ${n.on}`)}else if(b(a,Ye)){let o=a[le].name,u=a[le].schema,c=a[le].originalName,l=o===c?void 0:n.alias;r.push(v`${v.raw(n.joinType)} join${s} ${u?v`${v.identifier(u)}.`:void 0}${v.identifier(c)}${l&&v` ${v.identifier(l)}`} on ${n.on}`)}else r.push(v`${v.raw(n.joinType)} join${s} ${a} on ${n.on}`);i<e.length-1&&r.push(v` `)}return v.join(r)}buildFromTable(e){if(b(e,C)&&e[C.Symbol.OriginalName]!==e[C.Symbol.Name]){let r=v`${v.identifier(e[C.Symbol.OriginalName])}`;return e[C.Symbol.Schema]&&(r=v`${v.identifier(e[C.Symbol.Schema])}.${r}`),v`${r} ${v.identifier(e[C.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:i,where:n,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let g=i??Ct(r);for(let fe of g)if(b(fe.field,ee)&&lt(fe.field.table)!==(b(s,Pe)?s._.alias:b(s,sn)?s[le].name:b(s,A)?void 0:lt(s))&&!(_e=>o?.some(({alias:vt})=>vt===(_e[C.Symbol.IsAlias]?lt(_e):_e[C.Symbol.BaseName])))(fe.field.table)){let _e=lt(fe.field.table);throw new Error(`Your "${fe.path.join("->")}" field references a column "${_e}"."${fe.field.name}", but the table "${_e}" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),E;f&&(E=f===!0?v` distinct`:v` distinct on (${v.join(f.on,v`, `)})`);let S=this.buildSelection(g,{isSingleTable:x}),I=this.buildFromTable(s),$=this.buildJoins(o),R=n?v` where ${n}`:void 0,N=a?v` having ${a}`:void 0,D;u&&u.length>0&&(D=v` order by ${v.join(u,v`, `)}`);let X;c&&c.length>0&&(X=v` group by ${v.join(c,v`, `)}`);let je=typeof l=="object"||typeof l=="number"&&l>=0?v` limit ${l}`:void 0,at=p?v` offset ${p}`:void 0,$e=v.empty();if(d){let fe=v` for ${v.raw(d.strength)}`;d.config.of&&fe.append(v` of ${v.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],v`, `)}`),d.config.noWait?fe.append(v` no wait`):d.config.skipLocked&&fe.append(v` skip locked`),$e.append(fe)}let Se=v`${w}select${E} ${S} from ${I}${$}${R}${X}${N}${D}${je}${at}${$e}`;return y.length>0?this.buildSetOperations(Se,y):Se}buildSetOperations(e,r){let[i,...n]=r;if(!i)throw new Error("Cannot pass undefined values to any set operator");return n.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:i}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:i}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:i,rightSelect:n,limit:a,orderBy:s,offset:o}}){let u=v`(${e.getSQL()}) `,c=v`(${n.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let g of s)if(b(g,k))y.push(v.identifier(g.name));else if(b(g,A)){for(let x=0;x<g.queryChunks.length;x++){let w=g.queryChunks[x];b(w,k)&&(g.queryChunks[x]=v.identifier(w.name))}y.push(v`${g}`)}else y.push(v`${g}`);l=v` order by ${v.join(y,v`, `)} `}let p=typeof a=="object"||typeof a=="number"&&a>=0?v` limit ${a}`:void 0,d=v.raw(`${r} ${i?"all ":""}`),f=o?v` offset ${o}`:void 0;return v`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:i,returning:n,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[C.Symbol.Columns],l=Object.entries(c).filter(([w,E])=>!E.shouldDisableInsert()),p=l.map(([,w])=>v.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,A)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(v.raw("values "));for(let[E,S]of w.entries()){let I=[];for(let[$,R]of l){let N=S[$];if(N===void 0||b(N,pt)&&N.value===void 0)if(R.defaultFn!==void 0){let D=R.defaultFn(),X=b(D,A)?D:v.param(D,R);I.push(X)}else if(!R.default&&R.onUpdateFn!==void 0){let D=R.onUpdateFn(),X=b(D,A)?D:v.param(D,R);I.push(X)}else I.push(v`default`);else I.push(N)}u.push(I),E<w.length-1&&u.push(v`, `)}}let d=this.buildWithCTE(a),f=v.join(u),y=n?v` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,g=i?v` on conflict ${i}`:void 0,x=o===!0?v`overriding system value `:void 0;return v`${d}insert into ${e} ${p} ${x}${f}${g}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:i}){let n=r?v` concurrently`:void 0,a=i?v` with no data`:void 0;return v`refresh materialized view${n} ${e}${a}`}prepareTyping(e){return b(e,La)||b(e,Ma)?"json":b(e,Fa)?"decimal":b(e,za)?"time":b(e,$a)||b(e,Ua)?"timestamp":b(e,Da)||b(e,Ra)?"date":b(e,Qa)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:i,table:n,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,g=[];if(s===!0)l=Object.entries(a.columns).map(([E,S])=>({dbKey:S.name,tsKey:E,field:Gt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([N,D])=>[N,Gt(D,o)]));if(s.where){let N=typeof s.where=="function"?s.where(w,Vw()):s.where;y=N&&ja(N,o)}let E=[],S=[];if(s.columns){let N=!1;for(let[D,X]of Object.entries(s.columns))X!==void 0&&D in a.columns&&(!N&&X===!0&&(N=!0),S.push(D));S.length>0&&(S=N?S.filter(D=>s.columns?.[D]===!0):Object.keys(a.columns).filter(D=>!S.includes(D)))}else S=Object.keys(a.columns);for(let N of S){let D=a.columns[N];E.push({tsKey:N,value:D})}let I=[];s.with&&(I=Object.entries(s.with).filter(N=>!!N[1]).map(([N,D])=>({tsKey:N,queryConfig:D,relation:a.relations[N]})));let $;if(s.extras){$=typeof s.extras=="function"?s.extras(w,{sql:v}):s.extras;for(let[N,D]of Object.entries($))E.push({tsKey:N,value:up(D,o)})}for(let{tsKey:N,value:D}of E)l.push({dbKey:b(D,A.Aliased)?D.fieldAlias:a.columns[N].name,tsKey:N,field:b(D,ee)?Gt(D,o):D,relationTableTsKey:void 0,isJson:!1,selection:[]});let R=typeof s.orderBy=="function"?s.orderBy(w,Gw()):s.orderBy??[];Array.isArray(R)||(R=[R]),f=R.map(N=>b(N,ee)?Gt(N,o):ja(N,o)),p=s.limit,d=s.offset;for(let{tsKey:N,queryConfig:D,relation:X}of I){let je=Ww(r,i,X),at=Gr(X.referencedTable),$e=i[at],Se=`${o}_${N}`,fe=Wt(...je.fields.map((Ir,Dn)=>Z(Gt(je.references[Dn],Se),Gt(Ir,o)))),_e=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:i,table:e[$e],tableConfig:r[$e],queryConfig:b(X,br)?D===!0?{limit:1}:{...D,limit:1}:D,tableAlias:Se,joinOn:fe,nestedQueryRelation:X}),vt=v`${v.identifier(Se)}.${v.identifier("data")}`.as(N);g.push({on:v`true`,table:new Pe(_e.sql,{},Se),alias:Se,joinType:"left",lateral:!0}),l.push({dbKey:N,tsKey:N,field:vt,relationTableTsKey:$e,isJson:!0,selection:_e.selection})}}if(l.length===0)throw new Va({message:`No fields selected for table "${a.tsName}" ("${o}")`});let x;if(y=Wt(c,y),u){let w=v`json_build_array(${v.join(l.map(({field:I,tsKey:$,isJson:R})=>R?v`${v.identifier(`${o}_${$}`)}.${v.identifier("data")}`:b(I,A.Aliased)?I.sql:I),v`, `)})`;b(u,Ga)&&(w=v`coalesce(json_agg(${w}${f.length>0?v` order by ${v.join(f,v`, `)}`:void 0}), '[]'::json)`);let E=[{dbKey:"data",tsKey:"data",field:w.as("data"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:Oa(n,o),fields:{},fieldsFlat:[{path:[],field:v.raw("*")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=Oa(n,o),x=this.buildSelectQuery({table:b(x,Le)?x:new Pe(x,{},o),fields:{},fieldsFlat:E.map(({field:I})=>({path:[],field:b(I,ee)?Gt(I,o):I})),joins:g,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:Oa(n,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,ee)?Gt(w,o):w})),joins:g,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var Go=class{static[m]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var He=class{static[m]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,i=e,n;return this.fields?n=this.fields:b(i,Pe)?n=Object.fromEntries(Object.keys(i._.selectedFields).map(a=>[a,i[a]])):b(i,sn)?n=i[le].selectedFields:b(i,A)?n={}:n=Bo(i),new Ko({table:i,fields:n,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},Ad=class extends Go{static[m]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:i,session:n,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=i,this.session=n,this.dialect=a,this._={selectedFields:r},this.tableName=tr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,i)=>{let n=this.tableName,a=tr(r);if(typeof a=="string"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof n=="string"&&(this.config.fields={[n]:this.config.fields}),typeof a=="string"&&!b(r,A))){let s=b(r,Pe)?r._.selectedFields:b(r,Ye)?r[le].selectedFields:r[C.Symbol.Columns];this.config.fields[a]=s}if(typeof i=="function"&&(i=i(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:i,table:r,joinType:e,alias:a}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return i=>{let n=typeof i=="function"?i(A3()):i;if(!qa(this.getSelectedFields(),n.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),i=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=i:this.config.orderBy=i}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new Pe(this.getSQL(),this.config.fields,e),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new Te({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},Ko=class extends Ad{static[m]="PgSelect";_prepare(e){let{session:r,config:i,dialect:n,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ue.startActiveSpan("drizzle.prepareQuery",()=>{let o=Ct(i.fields),u=r.prepareQuery(n.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};J0(Ko,[Qe]);function on(t,e){return(r,i,...n)=>{let a=[i,...n].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!qa(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(a)}}var A3=()=>({union:P3,unionAll:I3,intersect:N3,intersectAll:O3,except:j3,exceptAll:q3}),P3=on("union",!1),I3=on("union",!0),N3=on("intersect",!1),O3=on("intersect",!0),j3=on("except",!1),q3=on("except",!0);var cn=class{static[m]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=b(e,wr)?e:void 0,this.dialectConfig=b(e,wr)?void 0:e}$with=(e,r)=>{let i=this;return{as:a=>(typeof a=="function"&&(a=a(i)),new Proxy(new Yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let r=this;function i(s){return new He({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function n(s){return new He({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new He({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:i,selectDistinct:n,selectDistinctOn:a}}select(e){return new He({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new He({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new He({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new wr(this.dialectConfig)),this.dialect}};var Ka=class{constructor(e,r,i,n,a){this.table=e,this.session=r,this.dialect=i,this.withList=n,this.overridingSystemValue_=a}static[m]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let r=e.map(i=>{let n={},a=this.table[C.Symbol.Columns];for(let s of Object.keys(i)){let o=i[s];n[s]=b(o,A)?o:new pt(o,a[s])}return n});return new Wo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e=="function"?e(new cn):e;if(!b(r,A)&&!qa(this.table[Do],r._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new Wo(this.table,r,this.session,this.dialect,this.withList,!0)}},Wo=class extends Qe{constructor(e,r,i,n,a,s,o){super(),this.session=i,this.dialect=n,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[m]="PgInsert";config;returning(e=this.config.table[C.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Ct(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=v`do nothing`;else{let r="";r=Array.isArray(e.target)?e.target.map(n=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(n))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let i=e.where?v` where ${e.where}`:void 0;this.config.onConflict=v`(${v.raw(r)})${i} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let r=e.where?v` where ${e.where}`:void 0,i=e.targetWhere?v` where ${e.targetWhere}`:void 0,n=e.setWhere?v` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,Ro(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=v`(${v.raw(s)})${i} do update set ${a}${r}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Te({alias:lt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Zo=class extends Qe{constructor(e,r,i){super(),this.session=r,this.dialect=i,this.config={view:e}}static[m]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Wa=class{constructor(e,r,i,n){this.table=e,this.session=r,this.dialect=i,this.withList=n}static[m]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Pd(this.table,Ro(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Pd=class extends Qe{constructor(e,r,i,n,a){super(),this.session=i,this.dialect=n,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=tr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[m]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let r=e,i=tr(r);return typeof i=="string"&&(this.joinsNotNullableMap[i]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Le)?e[C.Symbol.Columns]:b(e,Pe)?e._.selectedFields:e[le].selectedFields}createJoin(e){return(r,i)=>{let n=tr(r);if(typeof n=="string"&&this.config.joins.some(a=>a.alias===n))throw new Error(`Alias "${n}" is already used in this query`);if(typeof i=="function"){let a=this.config.from&&!b(this.config.from,A)?this.getTableLikeFields(this.config.from):void 0;i=i(new Proxy(this.config.table[C.Symbol.Columns],new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:i,table:r,joinType:e,alias:n}),typeof n=="string")switch(e){case"left":{this.joinsNotNullableMap[n]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[n]=!0;break}case"inner":{this.joinsNotNullableMap[n]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[n]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[C.Symbol.Columns]),this.config.from)){let r=tr(this.config.from);if(typeof r=="string"&&this.config.from&&!b(this.config.from,A)){let i=this.getTableLikeFields(this.config.from);e[r]=i}for(let i of this.config.joins){let n=tr(i.table);if(typeof n=="string"&&!b(i.table,A)){let a=this.getTableLikeFields(i.table);e[n]=a}}}return this.config.returningFields=e,this.config.returning=Ct(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Te({alias:lt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Jo=class t extends A{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[m]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,r){return v`(select count(*) from ${e}${v.raw(" where ").if(r)}${r})`}static buildCount(e,r){return v`select count(*) as count from ${e}${v.raw(" where ").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Xo=class{constructor(e,r,i,n,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=i,this.table=n,this.tableConfig=a,this.dialect=s,this.session=o}static[m]="PgRelationalQueryBuilder";findMany(e){return new Yo(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Yo(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},Yo=class extends Qe{constructor(e,r,i,n,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=i,this.table=n,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[m]="PgRelationalQuery";_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>{let{query:r,builtQuery:i}=this._toSQL();return this.session.prepareQuery(i,void 0,e,!0,(n,a)=>{let s=n.map(o=>Ho(this.schema,this.tableConfig,o,r.selection,a));return this.mode==="first"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var ec=class extends Qe{constructor(e,r,i,n){super(),this.execute=e,this.sql=r,this.query=i,this.mapBatchResult=n}static[m]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var un=class{constructor(e,r,i){if(this.dialect=e,this.session=r,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[n,a]of Object.entries(this._.schema))this.query[n]=new Xo(i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[n],a,e,r)}static[m]="PgDatabase";query;$with=(e,r)=>{let i=this;return{as:a=>(typeof a=="function"&&(a=a(new cn(i.dialect))),new Proxy(new Yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,r){return new Jo({source:e,filters:r,session:this.session})}with(...e){let r=this;function i(c){return new He({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function n(c){return new He({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new He({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Wa(c,r.session,r.dialect,e)}function o(c){return new Ka(c,r.session,r.dialect,e)}function u(c){return new Ha(c,r.session,r.dialect,e)}return{select:i,selectDistinct:n,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new He({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new He({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new He({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Wa(e,this.session,this.dialect)}insert(e){return new Ka(e,this.session,this.dialect)}delete(e){return new Ha(e,this.session,this.dialect)}refreshMaterializedView(e){return new Zo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e=="string"?v.raw(e):e.getSQL(),i=this.dialect.sqlToQuery(r),n=this.session.prepareQuery(i,void 0,void 0,!1);return new ec(()=>n.execute(void 0,this.authToken),r,i,a=>n.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var Id=class{constructor(e,r){this.unique=e,this.name=r}static[m]="PgIndexBuilderOn";on(...e){return new Za(e.map(r=>{if(b(r,A))return r;r=r;let i=new Xi(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),i}),this.unique,!1,this.name)}onOnly(...e){return new Za(e.map(r=>{if(b(r,A))return r;r=r;let i=new Xi(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,i}),this.unique,!0,this.name)}using(e,...r){return new Za(r.map(i=>{if(b(i,A))return i;i=i;let n=new Xi(i.name,!!i.keyAsName,i.columnType,i.indexConfig);return i.indexConfig=JSON.parse(JSON.stringify(i.defaultConfig)),n}),this.unique,!0,this.name,e)}},Za=class{static[m]="PgIndexBuilder";config;constructor(e,r,i,n,a="btree"){this.config={name:n,columns:e,unique:r,only:i,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new Nd(this.config,e)}},Nd=class{static[m]="PgIndex";config;constructor(e,r){this.config={...e,table:r}}};function Xw(t){return new Id(!1,t)}var tc=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[m]="PgPreparedQuery";joinsNotNullableMap},rc=class{constructor(e){this.dialect=e}static[m]="PgSession";execute(e,r){return ue.startActiveSpan("drizzle.operation",()=>ue.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let i=await this.execute(e,r);return Number(i[0].count)}},ic=class extends un{constructor(e,r,i,n=0){super(e,r,i),this.schema=i,this.nestedIndex=n}static[m]="PgTransaction";rollback(){throw new Fo}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable=="boolean"&&r.push(e.deferrable?"deferrable":"not deferrable"),v.raw(r.join(" "))}setTransaction(e){return this.session.execute(v`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Od=class{static[m]="ConsoleLogWriter";write(e){console.log(e)}},nc=class{static[m]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new Od}logQuery(e,r){let i=r.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),n=i.length?` -- params: [${i.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},ac=class{static[m]="NoopLogger";logQuery(){}};var J;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function r(n){throw new Error}t.assertNever=r,t.arrayToEnum=n=>{let a={};for(let s of n)a[s]=s;return a},t.getValidEnumValues=n=>{let a=t.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),s={};for(let o of a)s[o]=n[o];return t.objectValues(s)},t.objectValues=n=>t.objectKeys(n).map(function(a){return n[a]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let a=[];for(let s in n)Object.prototype.hasOwnProperty.call(n,s)&&a.push(s);return a},t.find=(n,a)=>{for(let s of n)if(a(s))return s},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function i(n,a=" | "){return n.map(s=>typeof s=="string"?`'${s}'`:s).join(a)}t.joinValues=i,t.jsonStringifyReplacer=(n,a)=>typeof a=="bigint"?a.toString():a})(J||(J={}));var qd;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(qd||(qd={}));var P=J.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),nr=t=>{switch(typeof t){case"undefined":return P.undefined;case"string":return P.string;case"number":return isNaN(t)?P.nan:P.number;case"boolean":return P.boolean;case"function":return P.function;case"bigint":return P.bigint;case"symbol":return P.symbol;case"object":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?P.promise:typeof Map<"u"&&t instanceof Map?P.map:typeof Set<"u"&&t instanceof Set?P.set:typeof Date<"u"&&t instanceof Date?P.date:P.object;default:return P.unknown}},_=J.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),D3=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),xt=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(a){return a.message},i={_errors:[]},n=a=>{for(let s of a.issues)if(s.code==="invalid_union")s.unionErrors.map(n);else if(s.code==="invalid_return_type")n(s.returnTypeError);else if(s.code==="invalid_arguments")n(s.argumentsError);else if(s.path.length===0)i._errors.push(r(s));else{let o=i,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return n(this),i}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,J.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},i=[];for(let n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):i.push(e(n));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}};xt.create=t=>new xt(t);var dn=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,J.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${J.joinValues(t.keys,", ")}`;break;case _.invalid_union:r="Invalid input";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${J.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${J.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r="Invalid function arguments";break;case _.invalid_return_type:r="Invalid function return type";break;case _.invalid_date:r="Invalid date";break;case _.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:J.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case _.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case _.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case _.custom:r="Invalid input";break;case _.invalid_intersection_types:r="Intersection results could not be merged";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r="Number must be finite";break;default:r=e.defaultError,J.assertNever(t)}return{message:r}},r1=dn;function R3(t){r1=t}function sc(){return r1}var oc=t=>{let{data:e,path:r,errorMaps:i,issueData:n}=t,a=[...r,...n.path||[]],s={...n,path:a};if(n.message!==void 0)return{...n,path:a,message:n.message};let o="",u=i.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...n,path:a,message:o}},B3=[];function T(t,e){let r=sc(),i=oc({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===dn?void 0:dn].filter(n=>!!n)});t.common.issues.push(i)}var Ve=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let i=[];for(let n of r){if(n.status==="aborted")return M;n.status==="dirty"&&e.dirty(),i.push(n.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,r){let i=[];for(let n of r){let a=await n.key,s=await n.value;i.push({key:a,value:s})}return t.mergeObjectSync(e,i)}static mergeObjectSync(e,r){let i={};for(let n of r){let{key:a,value:s}=n;if(a.status==="aborted"||s.status==="aborted")return M;a.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof s.value<"u"||n.alwaysSet)&&(i[a.value]=s.value)}return{status:e.value,value:i}}},M=Object.freeze({status:"aborted"}),pn=t=>({status:"dirty",value:t}),et=t=>({status:"valid",value:t}),Dd=t=>t.status==="aborted",Rd=t=>t.status==="dirty",Zr=t=>t.status==="valid",Ya=t=>typeof Promise<"u"&&t instanceof Promise;function cc(t,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)}function i1(t,e,r,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}var q;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(q||(q={}));var Ja,Xa,Pt=class{constructor(e,r,i,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=i,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Yw=(t,e)=>{if(Zr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new xt(t.common.issues);return this._error=r,this._error}}};function Q(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:i,description:n}=t;if(e&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(s,o)=>{var u,c;let{message:l}=t;return s.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:(u=l??i)!==null&&u!==void 0?u:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=l??r)!==null&&c!==void 0?c:o.defaultError}},description:n}}var H=class{get description(){return this._def.description}_getType(e){return nr(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ve,ctx:{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Ya(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let i=this.safeParse(e,r);if(i.success)return i.data;throw i.error}safeParse(e,r){var i;let n={common:{issues:[],async:(i=r?.async)!==null&&i!==void 0?i:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},a=this._parseSync({data:e,path:n.path,parent:n});return Yw(n,a)}"~validate"(e){var r,i;let n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)};if(!this["~standard"].async)try{let a=this._parseSync({data:e,path:[],parent:n});return Zr(a)?{value:a.value}:{issues:n.common.issues}}catch(a){!((i=(r=a?.message)===null||r===void 0?void 0:r.toLowerCase())===null||i===void 0)&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(a=>Zr(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(e,r){let i=await this.safeParseAsync(e,r);if(i.success)return i.data;throw i.error}async safeParseAsync(e,r){let i={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},n=this._parse({data:e,path:i.path,parent:i}),a=await(Ya(n)?n:Promise.resolve(n));return Yw(i,a)}refine(e,r){let i=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,a)=>{let s=e(n),o=()=>a.addIssue({code:_.custom,...i(n)});return typeof Promise<"u"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((i,n)=>e(i)?!0:(n.addIssue(typeof r=="function"?r(i,n):r),!1))}_refinement(e){return new bt({schema:this,typeName:B.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return At.create(this,this._def)}nullable(){return Jt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return sr.create(this)}promise(){return kr.create(this,this._def)}or(e){return ii.create([this,e],this._def)}and(e){return ni.create(this,e,this._def)}transform(e){return new bt({...Q(this._def),schema:this,typeName:B.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new ui({...Q(this._def),innerType:this,defaultValue:r,typeName:B.ZodDefault})}brand(){return new es({typeName:B.ZodBranded,type:this,...Q(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new li({...Q(this._def),innerType:this,catchValue:r,typeName:B.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return ts.create(this,e)}readonly(){return pi.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M3=/^c[^\s-]{8,}$/i,L3=/^[0-9a-z]+$/,F3=/^[0-9A-HJKMNP-TV-Z]{26}$/i,z3=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$3=/^[a-z0-9_-]{21}$/i,U3=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Q3=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,H3=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,V3="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",jd,G3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,K3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,W3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,J3=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,X3=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,n1="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Y3=new RegExp(`^${n1}$`);function a1(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function eI(t){return new RegExp(`^${a1(t)}$`)}function s1(t){let e=`${n1}T${a1(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function tI(t,e){return!!((e==="v4"||!e)&&G3.test(t)||(e==="v6"||!e)&&W3.test(t))}function rI(t,e){if(!U3.test(t))return!1;try{let[r]=t.split("."),i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function iI(t,e){return!!((e==="v4"||!e)&&K3.test(t)||(e==="v6"||!e)&&Z3.test(t))}var Sr=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),M}let i=new Ve,n;for(let a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="max")e.data.length>a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="length"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(n=this._getOrReturnCtx(e,n),s?T(n,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&T(n,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),i.dirty())}else if(a.kind==="email")H3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"email",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="emoji")jd||(jd=new RegExp(V3,"u")),jd.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"emoji",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="uuid")z3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"uuid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="nanoid")$3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"nanoid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid")M3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cuid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid2")L3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cuid2",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="ulid")F3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"ulid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),T(n,{validation:"url",code:_.invalid_string,message:a.message}),i.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"regex",code:_.invalid_string,message:a.message}),i.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),i.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),i.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),i.dirty()):a.kind==="datetime"?s1(a).test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"datetime",message:a.message}),i.dirty()):a.kind==="date"?Y3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"date",message:a.message}),i.dirty()):a.kind==="time"?eI(a).test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"time",message:a.message}),i.dirty()):a.kind==="duration"?Q3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"duration",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="ip"?tI(e.data,a.version)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"ip",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="jwt"?rI(e.data,a.alg)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"jwt",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="cidr"?iI(e.data,a.version)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cidr",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="base64"?J3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"base64",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="base64url"?X3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"base64url",code:_.invalid_string,message:a.message}),i.dirty()):J.assertNever(a);return{status:i.value,value:e.data}}_regex(e,r,i){return this.refinement(n=>e.test(n),{validation:r,code:_.invalid_string,...q.errToObj(i)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...q.errToObj(e)})}url(e){return this._addCheck({kind:"url",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...q.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...q.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...q.errToObj(e)})}datetime(e){var r,i;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(i=e?.local)!==null&&i!==void 0?i:!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Sr.create=t=>{var e;return new Sr({checks:[],typeName:B.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};function nI(t,e){let r=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,n=r>i?r:i,a=parseInt(t.toFixed(n).replace(".","")),s=parseInt(e.toFixed(n).replace(".",""));return a%s/Math.pow(10,n)}var Jr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),M}let i,n=new Ve;for(let a of this._def.checks)a.kind==="int"?J.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:_.invalid_type,expected:"integer",received:"float",message:a.message}),n.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="multipleOf"?nI(e.data,a.value)!==0&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_finite,message:a.message}),n.dirty()):J.assertNever(a);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:q.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:q.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:q.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&J.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Jr.create=t=>new Jr({checks:[],typeName:B.ZodNumber,coerce:t?.coerce||!1,...Q(t)});var Xr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==P.bigint)return this._getInvalidInput(e);let i,n=new Ve;for(let a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):J.assertNever(a);return{status:n.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return T(r,{code:_.invalid_type,expected:P.bigint,received:r.parsedType}),M}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:q.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Xr.create=t=>{var e;return new Xr({checks:[],typeName:B.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};var Yr=class extends H{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==P.boolean){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.boolean,received:i.parsedType}),M}return et(e.data)}};Yr.create=t=>new Yr({typeName:B.ZodBoolean,coerce:t?.coerce||!1,...Q(t)});var ei=class t extends H{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==P.date){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.date,received:a.parsedType}),M}if(isNaN(e.data.getTime())){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_date}),M}let i=new Ve,n;for(let a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),i.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),i.dirty()):J.assertNever(a);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:q.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:q.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};ei.create=t=>new ei({checks:[],coerce:t?.coerce||!1,typeName:B.ZodDate,...Q(t)});var fn=class extends H{_parse(e){if(this._getType(e)!==P.symbol){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.symbol,received:i.parsedType}),M}return et(e.data)}};fn.create=t=>new fn({typeName:B.ZodSymbol,...Q(t)});var ti=class extends H{_parse(e){if(this._getType(e)!==P.undefined){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.undefined,received:i.parsedType}),M}return et(e.data)}};ti.create=t=>new ti({typeName:B.ZodUndefined,...Q(t)});var ri=class extends H{_parse(e){if(this._getType(e)!==P.null){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,
==> Cloning from https://github.com/myfavoriteworkplace/Slot-Notifier
==> Checking out commit a4bd1ffb18e1094fe6f154f4c57cd7cbea8cb7b0 in branch main
==> Using Node.js version 22.16.0 (default)
==> Docs on specifying a Node.js version: https://render.com/docs/node-version
==> Running build command 'npm install; npm run build'...
added 499 packages, and audited 500 packages in 9s
70 packages are looking for funding
  run `npm fund` for details
3 high severity vulnerabilities
To address all issues, run:
  npm audit fix
Run `npm audit` for details.
> rest-express@1.0.0 build
> tsx script/build.ts
building client...
vite v7.3.0 building client environment for production...
transforming...
 2667 modules transformed.
rendering chunks...
computing gzip size...
../dist/public/index.html                   2.01 kB  gzip:   0.77 kB
../dist/public/assets/index-DSSnFeEq.css   74.17 kB  gzip:  12.29 kB
../dist/public/assets/index-SnJ7qBkr.js   591.47 kB  gzip: 174.93 kB
 built in 4.77s
(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
building server...
  dist/index.cjs  1.1mb 
 Done in 184ms
==> Uploading build...
==> Uploaded in 7.6s. Compression took 4.1s
==> Build successful 
==> Setting WEB_CONCURRENCY=1 by default, based on available CPUs in the instance
==> Deploying...
==> Running 'npm run start'
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/opt/render/project/src/dist/index.cjs:76
==> Exited with status 1
==> Common ways to troubleshoot your deploy: https://render.com/docs/troubleshooting-deploys
==> Running 'npm run start'
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/opt/render/project/src/dist/index.cjs:76
		`;await r.execute(v`CREATE SCHEMA IF NOT EXISTS ${v.identifier(a)}`),await r.execute(s);let u=(await r.all(v`select id, hash, created_at from ${v.identifier(a)}.${v.identifier(n)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(v.raw(p));await c.execute(v`insert into ${v.identifier(a)}.${v.identifier(n)} ("hash", "created_at") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[v`with `];for(let[i,n]of e.entries())r.push(v`${v.identifier(n._.alias)} as (${n._.sql})`),i<e.length-1&&r.push(v`, `);return r.push(v` `),v.join(r)}buildDeleteQuery({table:e,where:r,returning:i,withList:n}){let a=this.buildWithCTE(n),s=i?v` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,o=r?v` where ${r}`:void 0;return v`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let i=e[C.Symbol.Columns],n=Object.keys(i).filter(s=>r[s]!==void 0||i[s]?.onUpdateFn!==void 0),a=n.length;return v.join(n.flatMap((s,o)=>{let u=i[s],c=r[s]??v.param(u.onUpdateFn(),u),l=v`${v.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,v.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:r,where:i,returning:n,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Le.Symbol.Name],l=e[Le.Symbol.Schema],p=e[Le.Symbol.OriginalName],d=c===p?void 0:c,f=v`${l?v`${v.identifier(l)}.`:void 0}${v.identifier(p)}${d&&v` ${v.identifier(d)}`}`,y=this.buildUpdateSet(e,r),g=s&&v.join([v.raw(" from "),this.buildFromTable(s)]),x=this.buildJoins(o),w=n?v` returning ${this.buildSelection(n,{isSingleTable:!s})}`:void 0,E=i?v` where ${i}`:void 0;return v`${u}update ${f} set ${y}${g}${x}${E}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let i=e.length,n=e.flatMap(({field:a},s)=>{let o=[];if(b(a,A.Aliased)&&a.isSelectionField)o.push(v.identifier(a.fieldAlias));else if(b(a,A.Aliased)||b(a,A)){let u=b(a,A.Aliased)?a.sql:a;r?o.push(new A(u.queryChunks.map(c=>b(c,k)?v.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,A.Aliased)&&o.push(v` as ${v.identifier(a.fieldAlias)}`)}else b(a,ee)&&(r?o.push(v.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<i-1&&o.push(v`, `),o});return v.join(n)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[i,n]of e.entries()){i===0&&r.push(v` `);let a=n.table,s=n.lateral?v` lateral`:void 0;if(b(a,Le)){let o=a[Le.Symbol.Name],u=a[Le.Symbol.Schema],c=a[Le.Symbol.OriginalName],l=o===c?void 0:n.alias;r.push(v`${v.raw(n.joinType)} join${s} ${u?v`${v.identifier(u)}.`:void 0}${v.identifier(c)}${l&&v` ${v.identifier(l)}`} on ${n.on}`)}else if(b(a,Ye)){let o=a[le].name,u=a[le].schema,c=a[le].originalName,l=o===c?void 0:n.alias;r.push(v`${v.raw(n.joinType)} join${s} ${u?v`${v.identifier(u)}.`:void 0}${v.identifier(c)}${l&&v` ${v.identifier(l)}`} on ${n.on}`)}else r.push(v`${v.raw(n.joinType)} join${s} ${a} on ${n.on}`);i<e.length-1&&r.push(v` `)}return v.join(r)}buildFromTable(e){if(b(e,C)&&e[C.Symbol.OriginalName]!==e[C.Symbol.Name]){let r=v`${v.identifier(e[C.Symbol.OriginalName])}`;return e[C.Symbol.Schema]&&(r=v`${v.identifier(e[C.Symbol.Schema])}.${r}`),v`${r} ${v.identifier(e[C.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:i,where:n,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let g=i??Ct(r);for(let fe of g)if(b(fe.field,ee)&&lt(fe.field.table)!==(b(s,Pe)?s._.alias:b(s,sn)?s[le].name:b(s,A)?void 0:lt(s))&&!(_e=>o?.some(({alias:vt})=>vt===(_e[C.Symbol.IsAlias]?lt(_e):_e[C.Symbol.BaseName])))(fe.field.table)){let _e=lt(fe.field.table);throw new Error(`Your "${fe.path.join("->")}" field references a column "${_e}"."${fe.field.name}", but the table "${_e}" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),E;f&&(E=f===!0?v` distinct`:v` distinct on (${v.join(f.on,v`, `)})`);let S=this.buildSelection(g,{isSingleTable:x}),I=this.buildFromTable(s),$=this.buildJoins(o),R=n?v` where ${n}`:void 0,N=a?v` having ${a}`:void 0,D;u&&u.length>0&&(D=v` order by ${v.join(u,v`, `)}`);let X;c&&c.length>0&&(X=v` group by ${v.join(c,v`, `)}`);let je=typeof l=="object"||typeof l=="number"&&l>=0?v` limit ${l}`:void 0,at=p?v` offset ${p}`:void 0,$e=v.empty();if(d){let fe=v` for ${v.raw(d.strength)}`;d.config.of&&fe.append(v` of ${v.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],v`, `)}`),d.config.noWait?fe.append(v` no wait`):d.config.skipLocked&&fe.append(v` skip locked`),$e.append(fe)}let Se=v`${w}select${E} ${S} from ${I}${$}${R}${X}${N}${D}${je}${at}${$e}`;return y.length>0?this.buildSetOperations(Se,y):Se}buildSetOperations(e,r){let[i,...n]=r;if(!i)throw new Error("Cannot pass undefined values to any set operator");return n.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:i}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:i}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:i,rightSelect:n,limit:a,orderBy:s,offset:o}}){let u=v`(${e.getSQL()}) `,c=v`(${n.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let g of s)if(b(g,k))y.push(v.identifier(g.name));else if(b(g,A)){for(let x=0;x<g.queryChunks.length;x++){let w=g.queryChunks[x];b(w,k)&&(g.queryChunks[x]=v.identifier(w.name))}y.push(v`${g}`)}else y.push(v`${g}`);l=v` order by ${v.join(y,v`, `)} `}let p=typeof a=="object"||typeof a=="number"&&a>=0?v` limit ${a}`:void 0,d=v.raw(`${r} ${i?"all ":""}`),f=o?v` offset ${o}`:void 0;return v`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:i,returning:n,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[C.Symbol.Columns],l=Object.entries(c).filter(([w,E])=>!E.shouldDisableInsert()),p=l.map(([,w])=>v.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,A)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(v.raw("values "));for(let[E,S]of w.entries()){let I=[];for(let[$,R]of l){let N=S[$];if(N===void 0||b(N,pt)&&N.value===void 0)if(R.defaultFn!==void 0){let D=R.defaultFn(),X=b(D,A)?D:v.param(D,R);I.push(X)}else if(!R.default&&R.onUpdateFn!==void 0){let D=R.onUpdateFn(),X=b(D,A)?D:v.param(D,R);I.push(X)}else I.push(v`default`);else I.push(N)}u.push(I),E<w.length-1&&u.push(v`, `)}}let d=this.buildWithCTE(a),f=v.join(u),y=n?v` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,g=i?v` on conflict ${i}`:void 0,x=o===!0?v`overriding system value `:void 0;return v`${d}insert into ${e} ${p} ${x}${f}${g}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:i}){let n=r?v` concurrently`:void 0,a=i?v` with no data`:void 0;return v`refresh materialized view${n} ${e}${a}`}prepareTyping(e){return b(e,La)||b(e,Ma)?"json":b(e,Fa)?"decimal":b(e,za)?"time":b(e,$a)||b(e,Ua)?"timestamp":b(e,Da)||b(e,Ra)?"date":b(e,Qa)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:i,table:n,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,g=[];if(s===!0)l=Object.entries(a.columns).map(([E,S])=>({dbKey:S.name,tsKey:E,field:Gt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([N,D])=>[N,Gt(D,o)]));if(s.where){let N=typeof s.where=="function"?s.where(w,Vw()):s.where;y=N&&ja(N,o)}let E=[],S=[];if(s.columns){let N=!1;for(let[D,X]of Object.entries(s.columns))X!==void 0&&D in a.columns&&(!N&&X===!0&&(N=!0),S.push(D));S.length>0&&(S=N?S.filter(D=>s.columns?.[D]===!0):Object.keys(a.columns).filter(D=>!S.includes(D)))}else S=Object.keys(a.columns);for(let N of S){let D=a.columns[N];E.push({tsKey:N,value:D})}let I=[];s.with&&(I=Object.entries(s.with).filter(N=>!!N[1]).map(([N,D])=>({tsKey:N,queryConfig:D,relation:a.relations[N]})));let $;if(s.extras){$=typeof s.extras=="function"?s.extras(w,{sql:v}):s.extras;for(let[N,D]of Object.entries($))E.push({tsKey:N,value:up(D,o)})}for(let{tsKey:N,value:D}of E)l.push({dbKey:b(D,A.Aliased)?D.fieldAlias:a.columns[N].name,tsKey:N,field:b(D,ee)?Gt(D,o):D,relationTableTsKey:void 0,isJson:!1,selection:[]});let R=typeof s.orderBy=="function"?s.orderBy(w,Gw()):s.orderBy??[];Array.isArray(R)||(R=[R]),f=R.map(N=>b(N,ee)?Gt(N,o):ja(N,o)),p=s.limit,d=s.offset;for(let{tsKey:N,queryConfig:D,relation:X}of I){let je=Ww(r,i,X),at=Gr(X.referencedTable),$e=i[at],Se=`${o}_${N}`,fe=Wt(...je.fields.map((Ir,Dn)=>Z(Gt(je.references[Dn],Se),Gt(Ir,o)))),_e=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:i,table:e[$e],tableConfig:r[$e],queryConfig:b(X,br)?D===!0?{limit:1}:{...D,limit:1}:D,tableAlias:Se,joinOn:fe,nestedQueryRelation:X}),vt=v`${v.identifier(Se)}.${v.identifier("data")}`.as(N);g.push({on:v`true`,table:new Pe(_e.sql,{},Se),alias:Se,joinType:"left",lateral:!0}),l.push({dbKey:N,tsKey:N,field:vt,relationTableTsKey:$e,isJson:!0,selection:_e.selection})}}if(l.length===0)throw new Va({message:`No fields selected for table "${a.tsName}" ("${o}")`});let x;if(y=Wt(c,y),u){let w=v`json_build_array(${v.join(l.map(({field:I,tsKey:$,isJson:R})=>R?v`${v.identifier(`${o}_${$}`)}.${v.identifier("data")}`:b(I,A.Aliased)?I.sql:I),v`, `)})`;b(u,Ga)&&(w=v`coalesce(json_agg(${w}${f.length>0?v` order by ${v.join(f,v`, `)}`:void 0}), '[]'::json)`);let E=[{dbKey:"data",tsKey:"data",field:w.as("data"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:Oa(n,o),fields:{},fieldsFlat:[{path:[],field:v.raw("*")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=Oa(n,o),x=this.buildSelectQuery({table:b(x,Le)?x:new Pe(x,{},o),fields:{},fieldsFlat:E.map(({field:I})=>({path:[],field:b(I,ee)?Gt(I,o):I})),joins:g,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:Oa(n,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,ee)?Gt(w,o):w})),joins:g,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var Go=class{static[m]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var He=class{static[m]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,i=e,n;return this.fields?n=this.fields:b(i,Pe)?n=Object.fromEntries(Object.keys(i._.selectedFields).map(a=>[a,i[a]])):b(i,sn)?n=i[le].selectedFields:b(i,A)?n={}:n=Bo(i),new Ko({table:i,fields:n,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},Ad=class extends Go{static[m]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:i,session:n,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=i,this.session=n,this.dialect=a,this._={selectedFields:r},this.tableName=tr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,i)=>{let n=this.tableName,a=tr(r);if(typeof a=="string"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof n=="string"&&(this.config.fields={[n]:this.config.fields}),typeof a=="string"&&!b(r,A))){let s=b(r,Pe)?r._.selectedFields:b(r,Ye)?r[le].selectedFields:r[C.Symbol.Columns];this.config.fields[a]=s}if(typeof i=="function"&&(i=i(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:i,table:r,joinType:e,alias:a}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return i=>{let n=typeof i=="function"?i(A3()):i;if(!qa(this.getSelectedFields(),n.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),i=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=i:this.config.orderBy=i}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new Pe(this.getSQL(),this.config.fields,e),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new Te({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},Ko=class extends Ad{static[m]="PgSelect";_prepare(e){let{session:r,config:i,dialect:n,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ue.startActiveSpan("drizzle.prepareQuery",()=>{let o=Ct(i.fields),u=r.prepareQuery(n.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};J0(Ko,[Qe]);function on(t,e){return(r,i,...n)=>{let a=[i,...n].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!qa(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(a)}}var A3=()=>({union:P3,unionAll:I3,intersect:N3,intersectAll:O3,except:j3,exceptAll:q3}),P3=on("union",!1),I3=on("union",!0),N3=on("intersect",!1),O3=on("intersect",!0),j3=on("except",!1),q3=on("except",!0);var cn=class{static[m]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=b(e,wr)?e:void 0,this.dialectConfig=b(e,wr)?void 0:e}$with=(e,r)=>{let i=this;return{as:a=>(typeof a=="function"&&(a=a(i)),new Proxy(new Yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let r=this;function i(s){return new He({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function n(s){return new He({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new He({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:i,selectDistinct:n,selectDistinctOn:a}}select(e){return new He({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new He({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new He({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new wr(this.dialectConfig)),this.dialect}};var Ka=class{constructor(e,r,i,n,a){this.table=e,this.session=r,this.dialect=i,this.withList=n,this.overridingSystemValue_=a}static[m]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let r=e.map(i=>{let n={},a=this.table[C.Symbol.Columns];for(let s of Object.keys(i)){let o=i[s];n[s]=b(o,A)?o:new pt(o,a[s])}return n});return new Wo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e=="function"?e(new cn):e;if(!b(r,A)&&!qa(this.table[Do],r._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new Wo(this.table,r,this.session,this.dialect,this.withList,!0)}},Wo=class extends Qe{constructor(e,r,i,n,a,s,o){super(),this.session=i,this.dialect=n,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[m]="PgInsert";config;returning(e=this.config.table[C.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Ct(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=v`do nothing`;else{let r="";r=Array.isArray(e.target)?e.target.map(n=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(n))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let i=e.where?v` where ${e.where}`:void 0;this.config.onConflict=v`(${v.raw(r)})${i} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let r=e.where?v` where ${e.where}`:void 0,i=e.targetWhere?v` where ${e.targetWhere}`:void 0,n=e.setWhere?v` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,Ro(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=v`(${v.raw(s)})${i} do update set ${a}${r}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Te({alias:lt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Zo=class extends Qe{constructor(e,r,i){super(),this.session=r,this.dialect=i,this.config={view:e}}static[m]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Wa=class{constructor(e,r,i,n){this.table=e,this.session=r,this.dialect=i,this.withList=n}static[m]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Pd(this.table,Ro(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Pd=class extends Qe{constructor(e,r,i,n,a){super(),this.session=i,this.dialect=n,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=tr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[m]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let r=e,i=tr(r);return typeof i=="string"&&(this.joinsNotNullableMap[i]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Le)?e[C.Symbol.Columns]:b(e,Pe)?e._.selectedFields:e[le].selectedFields}createJoin(e){return(r,i)=>{let n=tr(r);if(typeof n=="string"&&this.config.joins.some(a=>a.alias===n))throw new Error(`Alias "${n}" is already used in this query`);if(typeof i=="function"){let a=this.config.from&&!b(this.config.from,A)?this.getTableLikeFields(this.config.from):void 0;i=i(new Proxy(this.config.table[C.Symbol.Columns],new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:i,table:r,joinType:e,alias:n}),typeof n=="string")switch(e){case"left":{this.joinsNotNullableMap[n]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[n]=!0;break}case"inner":{this.joinsNotNullableMap[n]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[n]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[C.Symbol.Columns]),this.config.from)){let r=tr(this.config.from);if(typeof r=="string"&&this.config.from&&!b(this.config.from,A)){let i=this.getTableLikeFields(this.config.from);e[r]=i}for(let i of this.config.joins){let n=tr(i.table);if(typeof n=="string"&&!b(i.table,A)){let a=this.getTableLikeFields(i.table);e[n]=a}}}return this.config.returningFields=e,this.config.returning=Ct(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Te({alias:lt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Jo=class t extends A{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[m]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,r){return v`(select count(*) from ${e}${v.raw(" where ").if(r)}${r})`}static buildCount(e,r){return v`select count(*) as count from ${e}${v.raw(" where ").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Xo=class{constructor(e,r,i,n,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=i,this.table=n,this.tableConfig=a,this.dialect=s,this.session=o}static[m]="PgRelationalQueryBuilder";findMany(e){return new Yo(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Yo(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},Yo=class extends Qe{constructor(e,r,i,n,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=i,this.table=n,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[m]="PgRelationalQuery";_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>{let{query:r,builtQuery:i}=this._toSQL();return this.session.prepareQuery(i,void 0,e,!0,(n,a)=>{let s=n.map(o=>Ho(this.schema,this.tableConfig,o,r.selection,a));return this.mode==="first"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var ec=class extends Qe{constructor(e,r,i,n){super(),this.execute=e,this.sql=r,this.query=i,this.mapBatchResult=n}static[m]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var un=class{constructor(e,r,i){if(this.dialect=e,this.session=r,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[n,a]of Object.entries(this._.schema))this.query[n]=new Xo(i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[n],a,e,r)}static[m]="PgDatabase";query;$with=(e,r)=>{let i=this;return{as:a=>(typeof a=="function"&&(a=a(new cn(i.dialect))),new Proxy(new Yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,r){return new Jo({source:e,filters:r,session:this.session})}with(...e){let r=this;function i(c){return new He({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function n(c){return new He({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new He({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Wa(c,r.session,r.dialect,e)}function o(c){return new Ka(c,r.session,r.dialect,e)}function u(c){return new Ha(c,r.session,r.dialect,e)}return{select:i,selectDistinct:n,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new He({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new He({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new He({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Wa(e,this.session,this.dialect)}insert(e){return new Ka(e,this.session,this.dialect)}delete(e){return new Ha(e,this.session,this.dialect)}refreshMaterializedView(e){return new Zo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e=="string"?v.raw(e):e.getSQL(),i=this.dialect.sqlToQuery(r),n=this.session.prepareQuery(i,void 0,void 0,!1);return new ec(()=>n.execute(void 0,this.authToken),r,i,a=>n.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var Id=class{constructor(e,r){this.unique=e,this.name=r}static[m]="PgIndexBuilderOn";on(...e){return new Za(e.map(r=>{if(b(r,A))return r;r=r;let i=new Xi(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),i}),this.unique,!1,this.name)}onOnly(...e){return new Za(e.map(r=>{if(b(r,A))return r;r=r;let i=new Xi(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,i}),this.unique,!0,this.name)}using(e,...r){return new Za(r.map(i=>{if(b(i,A))return i;i=i;let n=new Xi(i.name,!!i.keyAsName,i.columnType,i.indexConfig);return i.indexConfig=JSON.parse(JSON.stringify(i.defaultConfig)),n}),this.unique,!0,this.name,e)}},Za=class{static[m]="PgIndexBuilder";config;constructor(e,r,i,n,a="btree"){this.config={name:n,columns:e,unique:r,only:i,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new Nd(this.config,e)}},Nd=class{static[m]="PgIndex";config;constructor(e,r){this.config={...e,table:r}}};function Xw(t){return new Id(!1,t)}var tc=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[m]="PgPreparedQuery";joinsNotNullableMap},rc=class{constructor(e){this.dialect=e}static[m]="PgSession";execute(e,r){return ue.startActiveSpan("drizzle.operation",()=>ue.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let i=await this.execute(e,r);return Number(i[0].count)}},ic=class extends un{constructor(e,r,i,n=0){super(e,r,i),this.schema=i,this.nestedIndex=n}static[m]="PgTransaction";rollback(){throw new Fo}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable=="boolean"&&r.push(e.deferrable?"deferrable":"not deferrable"),v.raw(r.join(" "))}setTransaction(e){return this.session.execute(v`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Od=class{static[m]="ConsoleLogWriter";write(e){console.log(e)}},nc=class{static[m]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new Od}logQuery(e,r){let i=r.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),n=i.length?` -- params: [${i.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},ac=class{static[m]="NoopLogger";logQuery(){}};var J;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function r(n){throw new Error}t.assertNever=r,t.arrayToEnum=n=>{let a={};for(let s of n)a[s]=s;return a},t.getValidEnumValues=n=>{let a=t.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),s={};for(let o of a)s[o]=n[o];return t.objectValues(s)},t.objectValues=n=>t.objectKeys(n).map(function(a){return n[a]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let a=[];for(let s in n)Object.prototype.hasOwnProperty.call(n,s)&&a.push(s);return a},t.find=(n,a)=>{for(let s of n)if(a(s))return s},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function i(n,a=" | "){return n.map(s=>typeof s=="string"?`'${s}'`:s).join(a)}t.joinValues=i,t.jsonStringifyReplacer=(n,a)=>typeof a=="bigint"?a.toString():a})(J||(J={}));var qd;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(qd||(qd={}));var P=J.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),nr=t=>{switch(typeof t){case"undefined":return P.undefined;case"string":return P.string;case"number":return isNaN(t)?P.nan:P.number;case"boolean":return P.boolean;case"function":return P.function;case"bigint":return P.bigint;case"symbol":return P.symbol;case"object":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?P.promise:typeof Map<"u"&&t instanceof Map?P.map:typeof Set<"u"&&t instanceof Set?P.set:typeof Date<"u"&&t instanceof Date?P.date:P.object;default:return P.unknown}},_=J.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),D3=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),xt=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(a){return a.message},i={_errors:[]},n=a=>{for(let s of a.issues)if(s.code==="invalid_union")s.unionErrors.map(n);else if(s.code==="invalid_return_type")n(s.returnTypeError);else if(s.code==="invalid_arguments")n(s.argumentsError);else if(s.path.length===0)i._errors.push(r(s));else{let o=i,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return n(this),i}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,J.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},i=[];for(let n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):i.push(e(n));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}};xt.create=t=>new xt(t);var dn=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,J.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${J.joinValues(t.keys,", ")}`;break;case _.invalid_union:r="Invalid input";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${J.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${J.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r="Invalid function arguments";break;case _.invalid_return_type:r="Invalid function return type";break;case _.invalid_date:r="Invalid date";break;case _.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:J.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case _.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case _.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case _.custom:r="Invalid input";break;case _.invalid_intersection_types:r="Intersection results could not be merged";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r="Number must be finite";break;default:r=e.defaultError,J.assertNever(t)}return{message:r}},r1=dn;function R3(t){r1=t}function sc(){return r1}var oc=t=>{let{data:e,path:r,errorMaps:i,issueData:n}=t,a=[...r,...n.path||[]],s={...n,path:a};if(n.message!==void 0)return{...n,path:a,message:n.message};let o="",u=i.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...n,path:a,message:o}},B3=[];function T(t,e){let r=sc(),i=oc({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===dn?void 0:dn].filter(n=>!!n)});t.common.issues.push(i)}var Ve=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let i=[];for(let n of r){if(n.status==="aborted")return M;n.status==="dirty"&&e.dirty(),i.push(n.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,r){let i=[];for(let n of r){let a=await n.key,s=await n.value;i.push({key:a,value:s})}return t.mergeObjectSync(e,i)}static mergeObjectSync(e,r){let i={};for(let n of r){let{key:a,value:s}=n;if(a.status==="aborted"||s.status==="aborted")return M;a.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof s.value<"u"||n.alwaysSet)&&(i[a.value]=s.value)}return{status:e.value,value:i}}},M=Object.freeze({status:"aborted"}),pn=t=>({status:"dirty",value:t}),et=t=>({status:"valid",value:t}),Dd=t=>t.status==="aborted",Rd=t=>t.status==="dirty",Zr=t=>t.status==="valid",Ya=t=>typeof Promise<"u"&&t instanceof Promise;function cc(t,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)}function i1(t,e,r,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}var q;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(q||(q={}));var Ja,Xa,Pt=class{constructor(e,r,i,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=i,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Yw=(t,e)=>{if(Zr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new xt(t.common.issues);return this._error=r,this._error}}};function Q(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:i,description:n}=t;if(e&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(s,o)=>{var u,c;let{message:l}=t;return s.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:(u=l??i)!==null&&u!==void 0?u:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=l??r)!==null&&c!==void 0?c:o.defaultError}},description:n}}var H=class{get description(){return this._def.description}_getType(e){return nr(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ve,ctx:{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Ya(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let i=this.safeParse(e,r);if(i.success)return i.data;throw i.error}safeParse(e,r){var i;let n={common:{issues:[],async:(i=r?.async)!==null&&i!==void 0?i:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},a=this._parseSync({data:e,path:n.path,parent:n});return Yw(n,a)}"~validate"(e){var r,i;let n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)};if(!this["~standard"].async)try{let a=this._parseSync({data:e,path:[],parent:n});return Zr(a)?{value:a.value}:{issues:n.common.issues}}catch(a){!((i=(r=a?.message)===null||r===void 0?void 0:r.toLowerCase())===null||i===void 0)&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(a=>Zr(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(e,r){let i=await this.safeParseAsync(e,r);if(i.success)return i.data;throw i.error}async safeParseAsync(e,r){let i={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},n=this._parse({data:e,path:i.path,parent:i}),a=await(Ya(n)?n:Promise.resolve(n));return Yw(i,a)}refine(e,r){let i=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,a)=>{let s=e(n),o=()=>a.addIssue({code:_.custom,...i(n)});return typeof Promise<"u"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((i,n)=>e(i)?!0:(n.addIssue(typeof r=="function"?r(i,n):r),!1))}_refinement(e){return new bt({schema:this,typeName:B.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return At.create(this,this._def)}nullable(){return Jt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return sr.create(this)}promise(){return kr.create(this,this._def)}or(e){return ii.create([this,e],this._def)}and(e){return ni.create(this,e,this._def)}transform(e){return new bt({...Q(this._def),schema:this,typeName:B.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new ui({...Q(this._def),innerType:this,defaultValue:r,typeName:B.ZodDefault})}brand(){return new es({typeName:B.ZodBranded,type:this,...Q(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new li({...Q(this._def),innerType:this,catchValue:r,typeName:B.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return ts.create(this,e)}readonly(){return pi.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M3=/^c[^\s-]{8,}$/i,L3=/^[0-9a-z]+$/,F3=/^[0-9A-HJKMNP-TV-Z]{26}$/i,z3=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$3=/^[a-z0-9_-]{21}$/i,U3=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Q3=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,H3=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,V3="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",jd,G3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,K3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,W3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,J3=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,X3=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,n1="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Y3=new RegExp(`^${n1}$`);function a1(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function eI(t){return new RegExp(`^${a1(t)}$`)}function s1(t){let e=`${n1}T${a1(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function tI(t,e){return!!((e==="v4"||!e)&&G3.test(t)||(e==="v6"||!e)&&W3.test(t))}function rI(t,e){if(!U3.test(t))return!1;try{let[r]=t.split("."),i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function iI(t,e){return!!((e==="v4"||!e)&&K3.test(t)||(e==="v6"||!e)&&Z3.test(t))}var Sr=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),M}let i=new Ve,n;for(let a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="max")e.data.length>a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="length"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(n=this._getOrReturnCtx(e,n),s?T(n,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&T(n,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),i.dirty())}else if(a.kind==="email")H3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"email",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="emoji")jd||(jd=new RegExp(V3,"u")),jd.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"emoji",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="uuid")z3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"uuid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="nanoid")$3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"nanoid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid")M3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cuid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid2")L3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cuid2",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="ulid")F3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"ulid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),T(n,{validation:"url",code:_.invalid_string,message:a.message}),i.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"regex",code:_.invalid_string,message:a.message}),i.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),i.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),i.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),i.dirty()):a.kind==="datetime"?s1(a).test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"datetime",message:a.message}),i.dirty()):a.kind==="date"?Y3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"date",message:a.message}),i.dirty()):a.kind==="time"?eI(a).test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"time",message:a.message}),i.dirty()):a.kind==="duration"?Q3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"duration",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="ip"?tI(e.data,a.version)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"ip",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="jwt"?rI(e.data,a.alg)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"jwt",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="cidr"?iI(e.data,a.version)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cidr",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="base64"?J3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"base64",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="base64url"?X3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"base64url",code:_.invalid_string,message:a.message}),i.dirty()):J.assertNever(a);return{status:i.value,value:e.data}}_regex(e,r,i){return this.refinement(n=>e.test(n),{validation:r,code:_.invalid_string,...q.errToObj(i)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...q.errToObj(e)})}url(e){return this._addCheck({kind:"url",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...q.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...q.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...q.errToObj(e)})}datetime(e){var r,i;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(i=e?.local)!==null&&i!==void 0?i:!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Sr.create=t=>{var e;return new Sr({checks:[],typeName:B.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};function nI(t,e){let r=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,n=r>i?r:i,a=parseInt(t.toFixed(n).replace(".","")),s=parseInt(e.toFixed(n).replace(".",""));return a%s/Math.pow(10,n)}var Jr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),M}let i,n=new Ve;for(let a of this._def.checks)a.kind==="int"?J.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:_.invalid_type,expected:"integer",received:"float",message:a.message}),n.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="multipleOf"?nI(e.data,a.value)!==0&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_finite,message:a.message}),n.dirty()):J.assertNever(a);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:q.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:q.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:q.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&J.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Jr.create=t=>new Jr({checks:[],typeName:B.ZodNumber,coerce:t?.coerce||!1,...Q(t)});var Xr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==P.bigint)return this._getInvalidInput(e);let i,n=new Ve;for(let a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):J.assertNever(a);return{status:n.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return T(r,{code:_.invalid_type,expected:P.bigint,received:r.parsedType}),M}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:q.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Xr.create=t=>{var e;return new Xr({checks:[],typeName:B.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};var Yr=class extends H{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==P.boolean){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.boolean,received:i.parsedType}),M}return et(e.data)}};Yr.create=t=>new Yr({typeName:B.ZodBoolean,coerce:t?.coerce||!1,...Q(t)});var ei=class t extends H{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==P.date){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.date,received:a.parsedType}),M}if(isNaN(e.data.getTime())){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_date}),M}let i=new Ve,n;for(let a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),i.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),i.dirty()):J.assertNever(a);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:q.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:q.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};ei.create=t=>new ei({checks:[],coerce:t?.coerce||!1,typeName:B.ZodDate,...Q(t)});var fn=class extends H{_parse(e){if(this._getType(e)!==P.symbol){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.symbol,received:i.parsedType}),M}return et(e.data)}};fn.create=t=>new fn({typeName:B.ZodSymbol,...Q(t)});var ti=class extends H{_parse(e){if(this._getType(e)!==P.undefined){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.undefined,received:i.parsedType}),M}return et(e.data)}};ti.create=t=>new ti({typeName:B.ZodUndefined,...Q(t)});var ri=class extends H{_parse(e){if(this._getType(e)!==P.null){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,
		`;await r.execute(v`CREATE SCHEMA IF NOT EXISTS ${v.identifier(a)}`),await r.execute(s);let u=(await r.all(v`select id, hash, created_at from ${v.identifier(a)}.${v.identifier(n)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let p of l.sql)await c.execute(v.raw(p));await c.execute(v`insert into ${v.identifier(a)}.${v.identifier(n)} ("hash", "created_at") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[v`with `];for(let[i,n]of e.entries())r.push(v`${v.identifier(n._.alias)} as (${n._.sql})`),i<e.length-1&&r.push(v`, `);return r.push(v` `),v.join(r)}buildDeleteQuery({table:e,where:r,returning:i,withList:n}){let a=this.buildWithCTE(n),s=i?v` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,o=r?v` where ${r}`:void 0;return v`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let i=e[C.Symbol.Columns],n=Object.keys(i).filter(s=>r[s]!==void 0||i[s]?.onUpdateFn!==void 0),a=n.length;return v.join(n.flatMap((s,o)=>{let u=i[s],c=r[s]??v.param(u.onUpdateFn(),u),l=v`${v.identifier(this.casing.getColumnCasing(u))} = ${c}`;return o<a-1?[l,v.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:r,where:i,returning:n,withList:a,from:s,joins:o}){let u=this.buildWithCTE(a),c=e[Le.Symbol.Name],l=e[Le.Symbol.Schema],p=e[Le.Symbol.OriginalName],d=c===p?void 0:c,f=v`${l?v`${v.identifier(l)}.`:void 0}${v.identifier(p)}${d&&v` ${v.identifier(d)}`}`,y=this.buildUpdateSet(e,r),g=s&&v.join([v.raw(" from "),this.buildFromTable(s)]),x=this.buildJoins(o),w=n?v` returning ${this.buildSelection(n,{isSingleTable:!s})}`:void 0,E=i?v` where ${i}`:void 0;return v`${u}update ${f} set ${y}${g}${x}${E}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let i=e.length,n=e.flatMap(({field:a},s)=>{let o=[];if(b(a,A.Aliased)&&a.isSelectionField)o.push(v.identifier(a.fieldAlias));else if(b(a,A.Aliased)||b(a,A)){let u=b(a,A.Aliased)?a.sql:a;r?o.push(new A(u.queryChunks.map(c=>b(c,k)?v.identifier(this.casing.getColumnCasing(c)):c))):o.push(u),b(a,A.Aliased)&&o.push(v` as ${v.identifier(a.fieldAlias)}`)}else b(a,ee)&&(r?o.push(v.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<i-1&&o.push(v`, `),o});return v.join(n)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[i,n]of e.entries()){i===0&&r.push(v` `);let a=n.table,s=n.lateral?v` lateral`:void 0;if(b(a,Le)){let o=a[Le.Symbol.Name],u=a[Le.Symbol.Schema],c=a[Le.Symbol.OriginalName],l=o===c?void 0:n.alias;r.push(v`${v.raw(n.joinType)} join${s} ${u?v`${v.identifier(u)}.`:void 0}${v.identifier(c)}${l&&v` ${v.identifier(l)}`} on ${n.on}`)}else if(b(a,Ye)){let o=a[le].name,u=a[le].schema,c=a[le].originalName,l=o===c?void 0:n.alias;r.push(v`${v.raw(n.joinType)} join${s} ${u?v`${v.identifier(u)}.`:void 0}${v.identifier(c)}${l&&v` ${v.identifier(l)}`} on ${n.on}`)}else r.push(v`${v.raw(n.joinType)} join${s} ${a} on ${n.on}`);i<e.length-1&&r.push(v` `)}return v.join(r)}buildFromTable(e){if(b(e,C)&&e[C.Symbol.OriginalName]!==e[C.Symbol.Name]){let r=v`${v.identifier(e[C.Symbol.OriginalName])}`;return e[C.Symbol.Schema]&&(r=v`${v.identifier(e[C.Symbol.Schema])}.${r}`),v`${r} ${v.identifier(e[C.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:i,where:n,having:a,table:s,joins:o,orderBy:u,groupBy:c,limit:l,offset:p,lockingClause:d,distinct:f,setOperators:y}){let g=i??Ct(r);for(let fe of g)if(b(fe.field,ee)&&lt(fe.field.table)!==(b(s,Pe)?s._.alias:b(s,sn)?s[le].name:b(s,A)?void 0:lt(s))&&!(_e=>o?.some(({alias:vt})=>vt===(_e[C.Symbol.IsAlias]?lt(_e):_e[C.Symbol.BaseName])))(fe.field.table)){let _e=lt(fe.field.table);throw new Error(`Your "${fe.path.join("->")}" field references a column "${_e}"."${fe.field.name}", but the table "${_e}" is not part of the query! Did you forget to join it?`)}let x=!o||o.length===0,w=this.buildWithCTE(e),E;f&&(E=f===!0?v` distinct`:v` distinct on (${v.join(f.on,v`, `)})`);let S=this.buildSelection(g,{isSingleTable:x}),I=this.buildFromTable(s),$=this.buildJoins(o),R=n?v` where ${n}`:void 0,N=a?v` having ${a}`:void 0,D;u&&u.length>0&&(D=v` order by ${v.join(u,v`, `)}`);let X;c&&c.length>0&&(X=v` group by ${v.join(c,v`, `)}`);let je=typeof l=="object"||typeof l=="number"&&l>=0?v` limit ${l}`:void 0,at=p?v` offset ${p}`:void 0,$e=v.empty();if(d){let fe=v` for ${v.raw(d.strength)}`;d.config.of&&fe.append(v` of ${v.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],v`, `)}`),d.config.noWait?fe.append(v` no wait`):d.config.skipLocked&&fe.append(v` skip locked`),$e.append(fe)}let Se=v`${w}select${E} ${S} from ${I}${$}${R}${X}${N}${D}${je}${at}${$e}`;return y.length>0?this.buildSetOperations(Se,y):Se}buildSetOperations(e,r){let[i,...n]=r;if(!i)throw new Error("Cannot pass undefined values to any set operator");return n.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:i}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:i}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:i,rightSelect:n,limit:a,orderBy:s,offset:o}}){let u=v`(${e.getSQL()}) `,c=v`(${n.getSQL()})`,l;if(s&&s.length>0){let y=[];for(let g of s)if(b(g,k))y.push(v.identifier(g.name));else if(b(g,A)){for(let x=0;x<g.queryChunks.length;x++){let w=g.queryChunks[x];b(w,k)&&(g.queryChunks[x]=v.identifier(w.name))}y.push(v`${g}`)}else y.push(v`${g}`);l=v` order by ${v.join(y,v`, `)} `}let p=typeof a=="object"||typeof a=="number"&&a>=0?v` limit ${a}`:void 0,d=v.raw(`${r} ${i?"all ":""}`),f=o?v` offset ${o}`:void 0;return v`${u}${d}${c}${l}${p}${f}`}buildInsertQuery({table:e,values:r,onConflict:i,returning:n,withList:a,select:s,overridingSystemValue_:o}){let u=[],c=e[C.Symbol.Columns],l=Object.entries(c).filter(([w,E])=>!E.shouldDisableInsert()),p=l.map(([,w])=>v.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;b(w,A)?u.push(w):u.push(w.getSQL())}else{let w=r;u.push(v.raw("values "));for(let[E,S]of w.entries()){let I=[];for(let[$,R]of l){let N=S[$];if(N===void 0||b(N,pt)&&N.value===void 0)if(R.defaultFn!==void 0){let D=R.defaultFn(),X=b(D,A)?D:v.param(D,R);I.push(X)}else if(!R.default&&R.onUpdateFn!==void 0){let D=R.onUpdateFn(),X=b(D,A)?D:v.param(D,R);I.push(X)}else I.push(v`default`);else I.push(N)}u.push(I),E<w.length-1&&u.push(v`, `)}}let d=this.buildWithCTE(a),f=v.join(u),y=n?v` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,g=i?v` on conflict ${i}`:void 0,x=o===!0?v`overriding system value `:void 0;return v`${d}insert into ${e} ${p} ${x}${f}${g}${y}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:i}){let n=r?v` concurrently`:void 0,a=i?v` with no data`:void 0;return v`refresh materialized view${n} ${e}${a}`}prepareTyping(e){return b(e,La)||b(e,Ma)?"json":b(e,Fa)?"decimal":b(e,za)?"time":b(e,$a)||b(e,Ua)?"timestamp":b(e,Da)||b(e,Ra)?"date":b(e,Qa)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:i,table:n,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:u,joinOn:c}){let l=[],p,d,f=[],y,g=[];if(s===!0)l=Object.entries(a.columns).map(([E,S])=>({dbKey:S.name,tsKey:E,field:Gt(S,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([N,D])=>[N,Gt(D,o)]));if(s.where){let N=typeof s.where=="function"?s.where(w,Vw()):s.where;y=N&&ja(N,o)}let E=[],S=[];if(s.columns){let N=!1;for(let[D,X]of Object.entries(s.columns))X!==void 0&&D in a.columns&&(!N&&X===!0&&(N=!0),S.push(D));S.length>0&&(S=N?S.filter(D=>s.columns?.[D]===!0):Object.keys(a.columns).filter(D=>!S.includes(D)))}else S=Object.keys(a.columns);for(let N of S){let D=a.columns[N];E.push({tsKey:N,value:D})}let I=[];s.with&&(I=Object.entries(s.with).filter(N=>!!N[1]).map(([N,D])=>({tsKey:N,queryConfig:D,relation:a.relations[N]})));let $;if(s.extras){$=typeof s.extras=="function"?s.extras(w,{sql:v}):s.extras;for(let[N,D]of Object.entries($))E.push({tsKey:N,value:up(D,o)})}for(let{tsKey:N,value:D}of E)l.push({dbKey:b(D,A.Aliased)?D.fieldAlias:a.columns[N].name,tsKey:N,field:b(D,ee)?Gt(D,o):D,relationTableTsKey:void 0,isJson:!1,selection:[]});let R=typeof s.orderBy=="function"?s.orderBy(w,Gw()):s.orderBy??[];Array.isArray(R)||(R=[R]),f=R.map(N=>b(N,ee)?Gt(N,o):ja(N,o)),p=s.limit,d=s.offset;for(let{tsKey:N,queryConfig:D,relation:X}of I){let je=Ww(r,i,X),at=Gr(X.referencedTable),$e=i[at],Se=`${o}_${N}`,fe=Wt(...je.fields.map((Ir,Dn)=>Z(Gt(je.references[Dn],Se),Gt(Ir,o)))),_e=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:i,table:e[$e],tableConfig:r[$e],queryConfig:b(X,br)?D===!0?{limit:1}:{...D,limit:1}:D,tableAlias:Se,joinOn:fe,nestedQueryRelation:X}),vt=v`${v.identifier(Se)}.${v.identifier("data")}`.as(N);g.push({on:v`true`,table:new Pe(_e.sql,{},Se),alias:Se,joinType:"left",lateral:!0}),l.push({dbKey:N,tsKey:N,field:vt,relationTableTsKey:$e,isJson:!0,selection:_e.selection})}}if(l.length===0)throw new Va({message:`No fields selected for table "${a.tsName}" ("${o}")`});let x;if(y=Wt(c,y),u){let w=v`json_build_array(${v.join(l.map(({field:I,tsKey:$,isJson:R})=>R?v`${v.identifier(`${o}_${$}`)}.${v.identifier("data")}`:b(I,A.Aliased)?I.sql:I),v`, `)})`;b(u,Ga)&&(w=v`coalesce(json_agg(${w}${f.length>0?v` order by ${v.join(f,v`, `)}`:void 0}), '[]'::json)`);let E=[{dbKey:"data",tsKey:"data",field:w.as("data"),isJson:!0,relationTableTsKey:a.tsName,selection:l}];p!==void 0||d!==void 0||f.length>0?(x=this.buildSelectQuery({table:Oa(n,o),fields:{},fieldsFlat:[{path:[],field:v.raw("*")}],where:y,limit:p,offset:d,orderBy:f,setOperators:[]}),y=void 0,p=void 0,d=void 0,f=[]):x=Oa(n,o),x=this.buildSelectQuery({table:b(x,Le)?x:new Pe(x,{},o),fields:{},fieldsFlat:E.map(({field:I})=>({path:[],field:b(I,ee)?Gt(I,o):I})),joins:g,where:y,limit:p,offset:d,orderBy:f,setOperators:[]})}else x=this.buildSelectQuery({table:Oa(n,o),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:b(w,ee)?Gt(w,o):w})),joins:g,where:y,limit:p,offset:d,orderBy:f,setOperators:[]});return{tableTsKey:a.tsName,sql:x,selection:l}}};var Go=class{static[m]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var He=class{static[m]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,i=e,n;return this.fields?n=this.fields:b(i,Pe)?n=Object.fromEntries(Object.keys(i._.selectedFields).map(a=>[a,i[a]])):b(i,sn)?n=i[le].selectedFields:b(i,A)?n={}:n=Bo(i),new Ko({table:i,fields:n,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},Ad=class extends Go{static[m]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:i,session:n,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=i,this.session=n,this.dialect=a,this._={selectedFields:r},this.tableName=tr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,i)=>{let n=this.tableName,a=tr(r);if(typeof a=="string"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof n=="string"&&(this.config.fields={[n]:this.config.fields}),typeof a=="string"&&!b(r,A))){let s=b(r,Pe)?r._.selectedFields:b(r,Ye)?r[le].selectedFields:r[C.Symbol.Columns];this.config.fields[a]=s}if(typeof i=="function"&&(i=i(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:i,table:r,joinType:e,alias:a}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return i=>{let n=typeof i=="function"?i(A3()):i;if(!qa(this.getSelectedFields(),n.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),i=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=i:this.config.orderBy=i}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new Pe(this.getSQL(),this.config.fields,e),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new Te({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},Ko=class extends Ad{static[m]="PgSelect";_prepare(e){let{session:r,config:i,dialect:n,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ue.startActiveSpan("drizzle.prepareQuery",()=>{let o=Ct(i.fields),u=r.prepareQuery(n.sqlToQuery(this.getSQL()),o,e,!0);return u.joinsNotNullableMap=a,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};J0(Ko,[Qe]);function on(t,e){return(r,i,...n)=>{let a=[i,...n].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!qa(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(a)}}var A3=()=>({union:P3,unionAll:I3,intersect:N3,intersectAll:O3,except:j3,exceptAll:q3}),P3=on("union",!1),I3=on("union",!0),N3=on("intersect",!1),O3=on("intersect",!0),j3=on("except",!1),q3=on("except",!0);var cn=class{static[m]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=b(e,wr)?e:void 0,this.dialectConfig=b(e,wr)?void 0:e}$with=(e,r)=>{let i=this;return{as:a=>(typeof a=="function"&&(a=a(i)),new Proxy(new Yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let r=this;function i(s){return new He({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function n(s){return new He({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new He({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:i,selectDistinct:n,selectDistinctOn:a}}select(e){return new He({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new He({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new He({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new wr(this.dialectConfig)),this.dialect}};var Ka=class{constructor(e,r,i,n,a){this.table=e,this.session=r,this.dialect=i,this.withList=n,this.overridingSystemValue_=a}static[m]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let r=e.map(i=>{let n={},a=this.table[C.Symbol.Columns];for(let s of Object.keys(i)){let o=i[s];n[s]=b(o,A)?o:new pt(o,a[s])}return n});return new Wo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e=="function"?e(new cn):e;if(!b(r,A)&&!qa(this.table[Do],r._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new Wo(this.table,r,this.session,this.dialect,this.withList,!0)}},Wo=class extends Qe{constructor(e,r,i,n,a,s,o){super(),this.session=i,this.dialect=n,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[m]="PgInsert";config;returning(e=this.config.table[C.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Ct(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=v`do nothing`;else{let r="";r=Array.isArray(e.target)?e.target.map(n=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(n))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let i=e.where?v` where ${e.where}`:void 0;this.config.onConflict=v`(${v.raw(r)})${i} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let r=e.where?v` where ${e.where}`:void 0,i=e.targetWhere?v` where ${e.targetWhere}`:void 0,n=e.setWhere?v` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,Ro(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=v`(${v.raw(s)})${i} do update set ${a}${r}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Te({alias:lt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Zo=class extends Qe{constructor(e,r,i){super(),this.session=r,this.dialect=i,this.config={view:e}}static[m]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Wa=class{constructor(e,r,i,n){this.table=e,this.session=r,this.dialect=i,this.withList=n}static[m]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Pd(this.table,Ro(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Pd=class extends Qe{constructor(e,r,i,n,a){super(),this.session=i,this.dialect=n,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=tr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[m]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let r=e,i=tr(r);return typeof i=="string"&&(this.joinsNotNullableMap[i]=!0),this.config.from=r,this}getTableLikeFields(e){return b(e,Le)?e[C.Symbol.Columns]:b(e,Pe)?e._.selectedFields:e[le].selectedFields}createJoin(e){return(r,i)=>{let n=tr(r);if(typeof n=="string"&&this.config.joins.some(a=>a.alias===n))throw new Error(`Alias "${n}" is already used in this query`);if(typeof i=="function"){let a=this.config.from&&!b(this.config.from,A)?this.getTableLikeFields(this.config.from):void 0;i=i(new Proxy(this.config.table[C.Symbol.Columns],new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:i,table:r,joinType:e,alias:n}),typeof n=="string")switch(e){case"left":{this.joinsNotNullableMap[n]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[n]=!0;break}case"inner":{this.joinsNotNullableMap[n]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[n]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[C.Symbol.Columns]),this.config.from)){let r=tr(this.config.from);if(typeof r=="string"&&this.config.from&&!b(this.config.from,A)){let i=this.getTableLikeFields(this.config.from);e[r]=i}for(let i of this.config.joins){let n=tr(i.table);if(typeof n=="string"&&!b(i.table,A)){let a=this.getTableLikeFields(i.table);e[n]=a}}}return this.config.returningFields=e,this.config.returning=Ct(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Te({alias:lt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Jo=class t extends A{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[m]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,r){return v`(select count(*) from ${e}${v.raw(" where ").if(r)}${r})`}static buildCount(e,r){return v`select count(*) as count from ${e}${v.raw(" where ").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var Xo=class{constructor(e,r,i,n,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=i,this.table=n,this.tableConfig=a,this.dialect=s,this.session=o}static[m]="PgRelationalQueryBuilder";findMany(e){return new Yo(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Yo(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},Yo=class extends Qe{constructor(e,r,i,n,a,s,o,u,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=i,this.table=n,this.tableConfig=a,this.dialect=s,this.session=o,this.config=u,this.mode=c}static[m]="PgRelationalQuery";_prepare(e){return ue.startActiveSpan("drizzle.prepareQuery",()=>{let{query:r,builtQuery:i}=this._toSQL();return this.session.prepareQuery(i,void 0,e,!0,(n,a)=>{let s=n.map(o=>Ho(this.schema,this.tableConfig,o,r.selection,a));return this.mode==="first"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var ec=class extends Qe{constructor(e,r,i,n){super(),this.execute=e,this.sql=r,this.query=i,this.mapBatchResult=n}static[m]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var un=class{constructor(e,r,i){if(this.dialect=e,this.session=r,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[n,a]of Object.entries(this._.schema))this.query[n]=new Xo(i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[n],a,e,r)}static[m]="PgDatabase";query;$with=(e,r)=>{let i=this;return{as:a=>(typeof a=="function"&&(a=a(new cn(i.dialect))),new Proxy(new Yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,r){return new Jo({source:e,filters:r,session:this.session})}with(...e){let r=this;function i(c){return new He({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function n(c){return new He({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(c,l){return new He({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Wa(c,r.session,r.dialect,e)}function o(c){return new Ka(c,r.session,r.dialect,e)}function u(c){return new Ha(c,r.session,r.dialect,e)}return{select:i,selectDistinct:n,selectDistinctOn:a,update:s,insert:o,delete:u}}select(e){return new He({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new He({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new He({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Wa(e,this.session,this.dialect)}insert(e){return new Ka(e,this.session,this.dialect)}delete(e){return new Ha(e,this.session,this.dialect)}refreshMaterializedView(e){return new Zo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e=="string"?v.raw(e):e.getSQL(),i=this.dialect.sqlToQuery(r),n=this.session.prepareQuery(i,void 0,void 0,!1);return new ec(()=>n.execute(void 0,this.authToken),r,i,a=>n.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var Id=class{constructor(e,r){this.unique=e,this.name=r}static[m]="PgIndexBuilderOn";on(...e){return new Za(e.map(r=>{if(b(r,A))return r;r=r;let i=new Xi(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),i}),this.unique,!1,this.name)}onOnly(...e){return new Za(e.map(r=>{if(b(r,A))return r;r=r;let i=new Xi(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,i}),this.unique,!0,this.name)}using(e,...r){return new Za(r.map(i=>{if(b(i,A))return i;i=i;let n=new Xi(i.name,!!i.keyAsName,i.columnType,i.indexConfig);return i.indexConfig=JSON.parse(JSON.stringify(i.defaultConfig)),n}),this.unique,!0,this.name,e)}},Za=class{static[m]="PgIndexBuilder";config;constructor(e,r,i,n,a="btree"){this.config={name:n,columns:e,unique:r,only:i,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new Nd(this.config,e)}},Nd=class{static[m]="PgIndex";config;constructor(e,r){this.config={...e,table:r}}};function Xw(t){return new Id(!1,t)}var tc=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[m]="PgPreparedQuery";joinsNotNullableMap},rc=class{constructor(e){this.dialect=e}static[m]="PgSession";execute(e,r){return ue.startActiveSpan("drizzle.operation",()=>ue.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let i=await this.execute(e,r);return Number(i[0].count)}},ic=class extends un{constructor(e,r,i,n=0){super(e,r,i),this.schema=i,this.nestedIndex=n}static[m]="PgTransaction";rollback(){throw new Fo}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable=="boolean"&&r.push(e.deferrable?"deferrable":"not deferrable"),v.raw(r.join(" "))}setTransaction(e){return this.session.execute(v`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Od=class{static[m]="ConsoleLogWriter";write(e){console.log(e)}},nc=class{static[m]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new Od}logQuery(e,r){let i=r.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),n=i.length?` -- params: [${i.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},ac=class{static[m]="NoopLogger";logQuery(){}};var J;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function r(n){throw new Error}t.assertNever=r,t.arrayToEnum=n=>{let a={};for(let s of n)a[s]=s;return a},t.getValidEnumValues=n=>{let a=t.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),s={};for(let o of a)s[o]=n[o];return t.objectValues(s)},t.objectValues=n=>t.objectKeys(n).map(function(a){return n[a]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let a=[];for(let s in n)Object.prototype.hasOwnProperty.call(n,s)&&a.push(s);return a},t.find=(n,a)=>{for(let s of n)if(a(s))return s},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function i(n,a=" | "){return n.map(s=>typeof s=="string"?`'${s}'`:s).join(a)}t.joinValues=i,t.jsonStringifyReplacer=(n,a)=>typeof a=="bigint"?a.toString():a})(J||(J={}));var qd;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(qd||(qd={}));var P=J.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),nr=t=>{switch(typeof t){case"undefined":return P.undefined;case"string":return P.string;case"number":return isNaN(t)?P.nan:P.number;case"boolean":return P.boolean;case"function":return P.function;case"bigint":return P.bigint;case"symbol":return P.symbol;case"object":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?P.promise:typeof Map<"u"&&t instanceof Map?P.map:typeof Set<"u"&&t instanceof Set?P.set:typeof Date<"u"&&t instanceof Date?P.date:P.object;default:return P.unknown}},_=J.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),D3=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),xt=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(a){return a.message},i={_errors:[]},n=a=>{for(let s of a.issues)if(s.code==="invalid_union")s.unionErrors.map(n);else if(s.code==="invalid_return_type")n(s.returnTypeError);else if(s.code==="invalid_arguments")n(s.argumentsError);else if(s.path.length===0)i._errors.push(r(s));else{let o=i,u=0;for(;u<s.path.length;){let c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return n(this),i}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,J.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},i=[];for(let n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):i.push(e(n));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}};xt.create=t=>new xt(t);var dn=(t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===P.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,J.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${J.joinValues(t.keys,", ")}`;break;case _.invalid_union:r="Invalid input";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${J.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${J.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r="Invalid function arguments";break;case _.invalid_return_type:r="Invalid function return type";break;case _.invalid_date:r="Invalid date";break;case _.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:J.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case _.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case _.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case _.custom:r="Invalid input";break;case _.invalid_intersection_types:r="Intersection results could not be merged";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r="Number must be finite";break;default:r=e.defaultError,J.assertNever(t)}return{message:r}},r1=dn;function R3(t){r1=t}function sc(){return r1}var oc=t=>{let{data:e,path:r,errorMaps:i,issueData:n}=t,a=[...r,...n.path||[]],s={...n,path:a};if(n.message!==void 0)return{...n,path:a,message:n.message};let o="",u=i.filter(c=>!!c).slice().reverse();for(let c of u)o=c(s,{data:e,defaultError:o}).message;return{...n,path:a,message:o}},B3=[];function T(t,e){let r=sc(),i=oc({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===dn?void 0:dn].filter(n=>!!n)});t.common.issues.push(i)}var Ve=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let i=[];for(let n of r){if(n.status==="aborted")return M;n.status==="dirty"&&e.dirty(),i.push(n.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,r){let i=[];for(let n of r){let a=await n.key,s=await n.value;i.push({key:a,value:s})}return t.mergeObjectSync(e,i)}static mergeObjectSync(e,r){let i={};for(let n of r){let{key:a,value:s}=n;if(a.status==="aborted"||s.status==="aborted")return M;a.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof s.value<"u"||n.alwaysSet)&&(i[a.value]=s.value)}return{status:e.value,value:i}}},M=Object.freeze({status:"aborted"}),pn=t=>({status:"dirty",value:t}),et=t=>({status:"valid",value:t}),Dd=t=>t.status==="aborted",Rd=t=>t.status==="dirty",Zr=t=>t.status==="valid",Ya=t=>typeof Promise<"u"&&t instanceof Promise;function cc(t,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)}function i1(t,e,r,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}var q;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(q||(q={}));var Ja,Xa,Pt=class{constructor(e,r,i,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=i,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Yw=(t,e)=>{if(Zr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new xt(t.common.issues);return this._error=r,this._error}}};function Q(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:i,description:n}=t;if(e&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(s,o)=>{var u,c;let{message:l}=t;return s.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:(u=l??i)!==null&&u!==void 0?u:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=l??r)!==null&&c!==void 0?c:o.defaultError}},description:n}}var H=class{get description(){return this._def.description}_getType(e){return nr(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ve,ctx:{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Ya(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let i=this.safeParse(e,r);if(i.success)return i.data;throw i.error}safeParse(e,r){var i;let n={common:{issues:[],async:(i=r?.async)!==null&&i!==void 0?i:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},a=this._parseSync({data:e,path:n.path,parent:n});return Yw(n,a)}"~validate"(e){var r,i;let n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)};if(!this["~standard"].async)try{let a=this._parseSync({data:e,path:[],parent:n});return Zr(a)?{value:a.value}:{issues:n.common.issues}}catch(a){!((i=(r=a?.message)===null||r===void 0?void 0:r.toLowerCase())===null||i===void 0)&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(a=>Zr(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(e,r){let i=await this.safeParseAsync(e,r);if(i.success)return i.data;throw i.error}async safeParseAsync(e,r){let i={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},n=this._parse({data:e,path:i.path,parent:i}),a=await(Ya(n)?n:Promise.resolve(n));return Yw(i,a)}refine(e,r){let i=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,a)=>{let s=e(n),o=()=>a.addIssue({code:_.custom,...i(n)});return typeof Promise<"u"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((i,n)=>e(i)?!0:(n.addIssue(typeof r=="function"?r(i,n):r),!1))}_refinement(e){return new bt({schema:this,typeName:B.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return At.create(this,this._def)}nullable(){return Jt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return sr.create(this)}promise(){return kr.create(this,this._def)}or(e){return ii.create([this,e],this._def)}and(e){return ni.create(this,e,this._def)}transform(e){return new bt({...Q(this._def),schema:this,typeName:B.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new ui({...Q(this._def),innerType:this,defaultValue:r,typeName:B.ZodDefault})}brand(){return new es({typeName:B.ZodBranded,type:this,...Q(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new li({...Q(this._def),innerType:this,catchValue:r,typeName:B.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return ts.create(this,e)}readonly(){return pi.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M3=/^c[^\s-]{8,}$/i,L3=/^[0-9a-z]+$/,F3=/^[0-9A-HJKMNP-TV-Z]{26}$/i,z3=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$3=/^[a-z0-9_-]{21}$/i,U3=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Q3=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,H3=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,V3="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",jd,G3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,K3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,W3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,J3=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,X3=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,n1="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Y3=new RegExp(`^${n1}$`);function a1(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function eI(t){return new RegExp(`^${a1(t)}$`)}function s1(t){let e=`${n1}T${a1(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function tI(t,e){return!!((e==="v4"||!e)&&G3.test(t)||(e==="v6"||!e)&&W3.test(t))}function rI(t,e){if(!U3.test(t))return!1;try{let[r]=t.split("."),i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function iI(t,e){return!!((e==="v4"||!e)&&K3.test(t)||(e==="v6"||!e)&&Z3.test(t))}var Sr=class t extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.string,received:a.parsedType}),M}let i=new Ve,n;for(let a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="max")e.data.length>a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="length"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(n=this._getOrReturnCtx(e,n),s?T(n,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&T(n,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),i.dirty())}else if(a.kind==="email")H3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"email",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="emoji")jd||(jd=new RegExp(V3,"u")),jd.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"emoji",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="uuid")z3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"uuid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="nanoid")$3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"nanoid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid")M3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cuid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid2")L3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cuid2",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="ulid")F3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"ulid",code:_.invalid_string,message:a.message}),i.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),T(n,{validation:"url",code:_.invalid_string,message:a.message}),i.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"regex",code:_.invalid_string,message:a.message}),i.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),i.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),i.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),i.dirty()):a.kind==="datetime"?s1(a).test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"datetime",message:a.message}),i.dirty()):a.kind==="date"?Y3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"date",message:a.message}),i.dirty()):a.kind==="time"?eI(a).test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:_.invalid_string,validation:"time",message:a.message}),i.dirty()):a.kind==="duration"?Q3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"duration",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="ip"?tI(e.data,a.version)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"ip",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="jwt"?rI(e.data,a.alg)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"jwt",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="cidr"?iI(e.data,a.version)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"cidr",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="base64"?J3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"base64",code:_.invalid_string,message:a.message}),i.dirty()):a.kind==="base64url"?X3.test(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{validation:"base64url",code:_.invalid_string,message:a.message}),i.dirty()):J.assertNever(a);return{status:i.value,value:e.data}}_regex(e,r,i){return this.refinement(n=>e.test(n),{validation:r,code:_.invalid_string,...q.errToObj(i)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...q.errToObj(e)})}url(e){return this._addCheck({kind:"url",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...q.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...q.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...q.errToObj(e)})}datetime(e){var r,i;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(i=e?.local)!==null&&i!==void 0?i:!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Sr.create=t=>{var e;return new Sr({checks:[],typeName:B.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};function nI(t,e){let r=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,n=r>i?r:i,a=parseInt(t.toFixed(n).replace(".","")),s=parseInt(e.toFixed(n).replace(".",""));return a%s/Math.pow(10,n)}var Jr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.number,received:a.parsedType}),M}let i,n=new Ve;for(let a of this._def.checks)a.kind==="int"?J.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:_.invalid_type,expected:"integer",received:"float",message:a.message}),n.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="multipleOf"?nI(e.data,a.value)!==0&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_finite,message:a.message}),n.dirty()):J.assertNever(a);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:q.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:q.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:q.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&J.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Jr.create=t=>new Jr({checks:[],typeName:B.ZodNumber,coerce:t?.coerce||!1,...Q(t)});var Xr=class t extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==P.bigint)return this._getInvalidInput(e);let i,n=new Ve;for(let a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),T(i,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):J.assertNever(a);return{status:n.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return T(r,{code:_.invalid_type,expected:P.bigint,received:r.parsedType}),M}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:q.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Xr.create=t=>{var e;return new Xr({checks:[],typeName:B.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};var Yr=class extends H{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==P.boolean){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.boolean,received:i.parsedType}),M}return et(e.data)}};Yr.create=t=>new Yr({typeName:B.ZodBoolean,coerce:t?.coerce||!1,...Q(t)});var ei=class t extends H{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==P.date){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_type,expected:P.date,received:a.parsedType}),M}if(isNaN(e.data.getTime())){let a=this._getOrReturnCtx(e);return T(a,{code:_.invalid_date}),M}let i=new Ve,n;for(let a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),i.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(n=this._getOrReturnCtx(e,n),T(n,{code:_.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),i.dirty()):J.assertNever(a);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:q.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:q.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};ei.create=t=>new ei({checks:[],coerce:t?.coerce||!1,typeName:B.ZodDate,...Q(t)});var fn=class extends H{_parse(e){if(this._getType(e)!==P.symbol){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.symbol,received:i.parsedType}),M}return et(e.data)}};fn.create=t=>new fn({typeName:B.ZodSymbol,...Q(t)});var ti=class extends H{_parse(e){if(this._getType(e)!==P.undefined){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,expected:P.undefined,received:i.parsedType}),M}return et(e.data)}};ti.create=t=>new ti({typeName:B.ZodUndefined,...Q(t)});var ri=class extends H{_parse(e){if(this._getType(e)!==P.null){let i=this._getOrReturnCtx(e);return T(i,{code:_.invalid_type,
Need better ways to work with logs? Try theRende